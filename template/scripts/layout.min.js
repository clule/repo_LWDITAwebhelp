/*
  Copyright Â© 2017 Adobe Systems Incorporated.  All rights reserved.
  Generated by Adobe RoboHelp 2017
*/
!function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=(rh.$,rh.consts),g=rh.model,h=f("HASH_KEY_RH_SEARCH"),i=f("HASH_KEY_TOPIC"),j=f("HASH_KEY_UIMODE"),k=f("HASH_KEY_RH_TOCID"),l=f("HASH_KEY_RH_HIGHLIGHT"),m=f("HASH_KEY_RANDOM"),n=[l,f("HASH_KEY_RH_SYNS"),k],o=function(a,b){b=b;var c=e.filePath(b),d=e.extractHashString(b);d.length>0&&(d="#"+d);var h=e.urlParams(e.extractParamString(b)),i=!0,j=!1,k=void 0;try{for(var l,o=Array.from(n)[Symbol.iterator]();!(i=(l=o.next()).done);i=!0){var p=l.value;null!=a[p]&&(h[p]=a[p])}}catch(q){j=!0,k=q}finally{try{!i&&o["return"]&&o["return"]()}finally{if(j)throw k}}g.get(f("KEY_SCREEN_IOS"))&&(h[m]=e.uniqueId());var r=e.mapToEncodedString(h);return r.length>0&&(r="?"+r),""+c+r+d},p=e.queueUpdateHashMap,q=function(a){return null==a&&(a={}),a[j]=null,a[m]=null,a[k]||(a[k]=null),a[l]||(a[l]=null),a},r=function(a,b){a=e.fixRelativeUrl(a);var c=e.urlParams(e.extractParamString(a));return c[i]=e.stripParam(a),c=q(c),p(c,b)},s=function(a,b){var c={};return c[i]=a,c=q(c),p(c,b)},t=function(a){var b=void 0,c=a.newMap,d=a.oldMap,m=d[j],n=c[j];if(h in c){var p=c[h];b=p!==g.get(f("KEY_SEARCHED_TERM")),g.publish(f("KEY_SEARCH_TERM"),p,{sync:!0})}if("search"===n&&b&&window.gHost&&g.publish(f("EVT_QUERY_SEARCH_RESULTS"),!0),!n||c[i]){var q=void 0,r=g.get(f("KEY_TOPIC_IN_IFRAME"));i in c&&(q=c[i]),q||(q=r);var s=rh.model.get(rh.consts("KEY_FEATURE"));q||s&&s.showDefTopic===!1||(q=null!=window.gDefaultTopic?window.gDefaultTopic.substring(1):void 0);var t=q&&(q!==r||m!==n||d[l]!==c[l]||d[k]!==c[k]);t&&(e.stripBookmark(q)!==e.stripBookmark(r)&&e.runTopicLoadingAnimation(!0),g.publish(f("KEY_TOPIC_IN_IFRAME"),q),window.loadTopic(o(c,q)))}return g.publish(f("KEY_UI_MODE"),c[j])},u=function(a){var b=e.hashParams();if(a&&!b[j]){var c=decodeURI(document.location.href),d=window._getRelativeFileName(c,a),h=b[i];if(!h||e.filePath(d)!==e.filePath(h))return g.publish(f("KEY_TOPIC_IN_IFRAME"),d),r(d,!1)}},v=function(a){var b=a.absUrl;if(!e.isRootUrl()){if(!e.isRootUrl(b)){var c=void 0,d=void 0,g=e.getRootUrl();e.isExternalUrl(b)?d=b:(c=e.getParamsForRoot(b),d=e.fixRelativeUrl(e.makeRelativePath(b,g))),b=""+g+c+"#t="+encodeURIComponent(d)}return document.location.href=b}if(!e.isUrlAllowdInIframe(b))return s(b,!0);if(b=e.makeRelativeUrl(e.fixRelativeUrl(b)),e.isHomeUrl(b))return document.location.href=b;var h=b&&e.filePath(b);if(h===f("START_FILEPATH")?b=b.substring(h.length):b||(b="#ux"),"#"===b[0]||"?"===b[0]){var i=e.hashParams(e.extractHashString(b));return j in i||(i[j]=null),p(i,!0)}return b?r(b,!0):void 0};g.subscribe(f("EVT_WIDGET_LOADED"),function(){return e.addEventListener(document,"click",e.hookClick),g.subscribe(f("EVT_HASH_CHANGE"),t),g.subscribe(f("KEY_TOPIC_URL"),u),g.subscribe(f("EVT_NAVIGATE_TO_URL"),v),g.subscribe(f("KEY_TOPIC_IN_IFRAME"),function(a){if(""+window.gHost+window.gHostPath!="/"&&(window.setTopic&&window.setTopic(),window.changeTopicLink))return window.changeTopicLink(document.location.toString())}),g.subscribe(f("EVT_TOPIC_LOADED"),function(){return e.runTopicLoadingAnimation(!1)}),g.subscribe(f("EVT_INSIDE_IFRAME_DOM_CONTENTLOADED"),function(){return e.runTopicLoadingAnimation(!1)})})},{}],2:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=window,rh=h.rh,i=rh.model,j=rh._,k=rh.consts,l=(rh.http,function(){var a=void 0;return l=function(b){function c(a){d(this,c);var b=e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return b.data=[],b.chunkCount=0,b.count=0,b.keys="",b.alhpabet="",b.loadNavData("glo"),b.filter="",b.widget=a,b.widget.publish("show",{}),b}return f(c,b),g(c,null,[{key:"initClass",value:function(){a="entrys"}}]),g(c,[{key:"addElement",value:function(b,c){var d=this;return function(){var e=[];return j.each(b[a],function(a){null!=a&&(d.lookup(c,a)?e.push(void 0):e.push(c.push(a)))},d),e}()}},{key:"exists",value:function(a){var b=this.alphaText(a);return this.alhpabet.indexOf(b)>-1||(this.alhpabet+=b,!1)}},{key:"isFiltered",value:function(a,b){var c=b?i.get(b):this.filter;return c&&a.toLocaleLowerCase().indexOf(c.toLocaleLowerCase())===-1}},{key:"alphaText",value:function(a){return a.toUpperCase().charAt(0)}},{key:"filterGlo",value:function(a){return this.filter=a.toLocaleLowerCase(),this.alhpabet="",i.publish(k("PROJECT_GLOSSARY_DATA"),i.get(k("PROJECT_GLOSSARY_DATA")))}}]),c}(rh.NavController),l.initClass(),l}());rh.controller("GlossaryController",l)},{}],3:[function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){return"undefined"!=typeof a&&null!==a?b(a):void 0}var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=window,rh=j.rh,k=rh.model,l=rh._,m=rh.consts,n=rh.http,o=rh.rhs,p="topics",q=function(){function a(){g(this,a),this.updateData=this.updateData.bind(this)}return i(a,[{key:"lookup",value:function(a,b){var c=void 0;return null!=a&&null!=b&&l.any(a,function(a){if(null!=a)return b.type===a.type&&b.name===a.name&&l.isEqual(b.url,a.url)&&(c=a),null!=c},this),c}},{key:"sort",value:function(a){return a.sort(function(a,b){return window.compare(a.name,b.name)})}},{key:"updateData",value:function(a,b){var c=k.get(m("KEY_TEMP_DATA"))||[];if(k.publish(m("KEY_TEMP_DATA")),this.addElement(c,this.data,b,this.keys),0===--this.chunkCount&&0===this.count)return this.sort(this.data),k.publish(m(a),this.data)}},{key:"getChunkData",value:function(a,b){this.count--;var c=h(k.get(m("KEY_TEMP_DATA")),function(a){return a.chunkinfos})||[];return this.chunkCount+=c.length,l.each(c,function(c){var d=this;return a&&(a=l.ensureSlash(a)),l.loadScript(a+"whxdata/"+c.node+".new.js",!1,function(){return d.updateData(b,a)})},this)}},{key:"loadNavData",value:function(a){var b=this;return k.subscribe(m("KEY_PROJECT_LIST"),function(c){return b.alhpabet="",b.count+=c.length,l.each(c,function(b){var c=this;return b&&(b=l.ensureSlash(b)),l.loadScript(b+"whxdata/"+("ndx"===a?"idx":"glo")+".new.js",!1,function(){return c.getChunkData(b,"ndx"===a?"PROJECT_INDEX_DATA":"PROJECT_GLOSSARY_DATA")})},b)})}}]),a}();rh.NavController=q;var r=function(){var a=void 0;return r=function(b){function c(a){g(this,c);var b=e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return b.data=[],b.chunkCount=0,b.count=0,b.alhpabet="",b.filter="",b.keys="keys",b.widget=a,k.subscribeOnce(m("EVT_PROJECT_LOADED"),function(){return b.loadNavData("ndx"),b.getIndexData(),k.subscribe(m("KEY_INDEX_FILTER"),function(){return b.alhpabet=""})}),b}return f(c,b),i(c,null,[{key:"initClass",value:function(){a=""}}]),i(c,[{key:"addElement",value:function(b,c,d,e){var f=this;if(null!=b[e])return function(){var g=[];return l.each(b[e],function(b){if(null!=b){var e;if(!(e=f.lookup(c,b))){var h={type:b.type,name:b.name};b["data-rhtags"]&&(h["data-rhtags"]=b["data-rhtags"]+"+"+d),b.url||(h[p]=[]);var i=l.makeRelativeUrl(""+d,a);null!=b.url&&(h.url=""+encodeURI(i)+b.url),null==b.url&&(h[f.keys]=[]),c.push(h),e=c[c.length-1]}f.addElement(b,e[f.keys],d,f.keys),g.push(f.addElement(b,e[p],d,p))}},f),g}()}},{key:"showItem",value:function(a){var b=k.get(m("KEY_INDEX_FILTER"));return!b||a.toLocaleLowerCase().indexOf(b.toLocaleLowerCase())!==-1}},{key:"showCategory",value:function(a,b){if(b>0)return!1;var c=this.alphaText(a);return!(this.alhpabet.indexOf(c)>-1)&&(this.alhpabet+=c,!0)}},{key:"showNextLevel",value:function(a){for(var b=a.getAttribute("data-indexid"),c=this.widget.get("show."+b),e=d({},b,!c);b;)b=b.substr(0,b.lastIndexOf("_")),e[b]=!0;return this.widget.publish("show",e)}},{key:"alphaText",value:function(a){return a.toUpperCase().charAt(0)}},{key:"getIndexData",value:function(){return k.subscribeOnce(m("KEY_PUBLISH_BASE_URL"),function(){try{var a=k.get(m("KEY_PUBLISH_BASE_URL")),b=document.location.origin,c=a.substr(b.length);l.parentPath(l.filePath(l.getRootUrl()));if(c&&!l.isEmptyString(c)){var d=l.mapToEncodedString(l.extend(l.addPathNameKey({area:o.area(),prj:o.project(),type:o.type(),agt:"ndx",mgr:"agm"})));return n.get(c+"?"+d).success(function(a,b){a=JSON.parse(a);var c=[],d=[],e=a.allProjects,f=a,g=f.masterProjects;e.length&&(e[0]=l.ensureSlash(e[0]));var h=function(a,b){return l.each(a,function(a){return b.push(l.makeRelativeUrl(a,e[0]))})};h(e,c),h(g,d);var i=function(a,b,c){l.isEmptyString(a)&&(c[b]=".")};return l.each(c,i),l.each(d,i),k.publish(m("KEY_PROJECT_LIST"),c),k.publish(m("KEY_MASTER_PROJECT_LIST"),d)})}}catch(e){if(rh._debug)return rh._d("warn",e.message)}})}}]),c}(rh.NavController),r.initClass(),r}();rh.controller("IndexController",r)},{}],4:[function(a,b,c){"use strict";var rh=a("../../src/lib/rh"),d=rh._;d.findEditDist=function(a,b){if(a==b)return 0;for(var c=[],d=[],e=0;e<b.length+1;e++)c.push(e),d.push(0);for(var e=0;e<a.length;e++){d[0]=e+1;for(var f=0;f<b.length;f++){var g=void 0;g=a[e]==b[f]?0:1,d[f+1]=Math.min(d[f]+1,c[f+1]+1,c[f]+g)}for(var f=0;f<c.length;f++)c[f]=d[f]}return d[d.length-1]}},{"../../src/lib/rh":24}],5:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){return function(){return a.apply(b,arguments)}},rh=a("../../src/lib/rh"),g=a("../../src/responsive_help/utils/node_utils"),h=rh._,i=rh.$,j=rh.model,k=rh.consts,l=k("KEY_TOC_DRILL_DOWN"),m=700,n=void 0,o=void 0;n=function(){var a=function(){function a(){d(this,a)}return e(a,[{key:"sync",value:function(a,b){var c=void 0;return a.updateActiveBookInfo(0,"_"),c=a.widget.node,this.reset(b),this.syncToProjectToc(a,c.children,function(b){return function(c){return b.syncToTocItem(a,c)}}(this))}},{key:"reset",value:function(a){var b=void 0;return this.parseTocInfo(a),b=this.order.lastIndexOf("@"),this.parentOrder=b!==-1?this.order.substring(0,b):""}},{key:"parseTocInfo",value:function(a){var b=void 0;return this.order=a.childOrder||"",b=h.splitAndTrim(a.childPrefix,"."),this.tocPath=h.reduce(b,function(a,b){var c=void 0,d=void 0;return c=h.splitAndTrim(b,"@"),(d=c.shift())&&a.push({bookNo:h.parseInt(d,0),order:c.length>0?"@"+c.join("@"):""}),a},[]),b=h.splitAndTrim(a.topicID||"0","_"),this.bookNos=h.map(b.shift().split("."),function(a){return h.parseInt(a,0)}),this.pageNo=h.parseInt(b.shift(),0)}},{key:"syncToProjectToc",value:function(a,b,c){var d=void 0,e=void 0,f=void 0;if(this.tocPath.length>0){if(d=0,f=this.tocPath.shift(),e=h.findIndex(b,function(b){var c=void 0;return c=i.dataset(b,"childorder")||"",!(c!==f.order||!a.isBookNode(b)||(d++,d!==f.bookNo))}),e!==-1)return a.openBook(b[e],!0,function(d){return function(){return h.defer(function(){var f=void 0,g=void 0;if(f=b[e+1],g=f.children&&f.children[0])return d.syncToProjectToc(a,g.children,c)})}}(this))}else if(c)return c(b)}},{key:"syncToTocItem",value:function(a,b,c){var d=void 0,e=void 0,f=void 0;return null==c&&(c=1),e=0,d=0,f=null,h.any(b,function(b){return function(g){var j=void 0,k=void 0,l=void 0,n=void 0,o=void 0;if(k=i.dataset(g,"childorder")||"",k===b.order&&(a.isBookNode(g)&&(j=g,f=j),j&&d++,b.bookNos[0]===d)){if(a.isPageNode(g)&&(n=g),n&&e++,1===b.bookNos.length)0===b.pageNo?(o=g,f&&a.openBook(f,!0,function(){return a.updateBookInfo()})):n&&e===b.pageNo&&(o=g),a.updateBookInfo(),o&&a.selectLink(o,!0,c);else if(f&&(l=i.hasClass(g,"child")))return b.bookNos.shift(),a.openBook(f,!0,function(){return h.defer(function(){var c=void 0;if(c=g.children&&g.children[0])return b.syncToTocItem(a,c.children,m)})}),!0;return null!=o}}}(this))}}]),a}();return a}(),o=function(){var a=void 0,b=void 0,c=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0;c="expanded",a="active",b="collapsing",o="expanding",v="loading-book",w="selected",t="show_child",r="bookid",p="active_bookid",s="level",q="active_level",u=".p.toc";var x="curtoc",y="data-tocitem",z=k("KEY_TOC_BREADCRUMBS"),A=function(){function A(a){var b=this;d(this,A),this.widget=a,this.subscribeTopicID=f(this.subscribeTopicID,this),this.onClick=f(this.onClick,this),this.updateBookInfo=f(this.updateBookInfo,this),this._data={},this.projectAbsRef=[],null==this.syncToc&&(this.syncToc=new n),this.widget.publish(s,0),this.widget.publish(r,"_"),rh.model.subscribe(u,function(a){b.widget.publish(x,a),b.widget.publish("curlevel",0)}),this.widget.subscribe(k("KEY_TOC_SELECT_ITEM"),this.selectTocItem.bind(this)),j.subscribeOnce([k("EVT_PROJECT_LOADED"),k("KEY_TOC_ORDER")],function(a){return function(){return j.get(k("KEY_PUBLISH_MODE"))?a.getTOCData():a.loadToc(u,"",function(){return a.widget.publish(k("EVT_TOC_LOADED"),!0),h.defer(function(){return a.widget.subscribe(rh.consts("KEY_TOPIC_ID"),a.subscribeTopicID)})})}}(this))}return e(A,[{key:"expandBook",value:function(a,b,c,d){this.selectTocItem({id:b});var e=i.getAttribute(c,"data-itemkey");rh.model.publish("EVT_TOC_LOADEDgototab",{tab:0,key:e,item:d})}},{key:"updateBookInfo",value:function(){var a=void 0,b=void 0;if(a=this.widget.get(p),null!=a&&a!==this.widget.get(r)&&this.widget.publish(r,a),b=this.widget.get(q),null!=b&&b!==this.widget.get(s))return this.widget.publish(s,b)}},{key:"updateActiveBookInfo",value:function(a,b){return this.widget.publish(p,b),this.widget.publish(q,a)}},{key:"getText",value:function(a){return a.textContent.trim()}},{key:"_getPreviousItemNode",value:function(a){var b=this.pid(i.getAttribute(a,"data-itemid"));return i.find(this.widget.node,'[data-itemid="'+b+'"]')[0]}},{key:"updateBreadcrumbInfo",value:function(a){var b=a,c=void 0,d=[];if(this.isTOCItem(a)){for(d.push(this._createBreadcrumbItem(b));c=this._getPreviousItemNode(b);)d.push(this._createBreadcrumbItem(c)),b=c;d.reverse(),d.length>0&&(d[d.length-1].lastNode=!0),d.curlevel=this.widget.get("curlevel"),this.widget.publish(z,d)}}},{key:"_createBreadcrumbItem",value:function(a){var b=a;this.hasTOCItemLink(a)||(b=this._findFirstLink(a));var c=b&&(i.getAttribute(b,"href")||i.getAttribute(b,"link"))||"#";return{id:i.getAttribute(a,"data-itemid"),text:this.getText(a),url:c,hasUrl:this.hasTOCItemLink(a),lastNode:!1}}},{key:"isTOCItem",value:function(a){return"LI"===i.nodeName(a)||i.getAttribute(a,y)}},{key:"_findFirstLink",value:function(a){var b={that:this},c=g.parentNode(a);return b.bookid=i.getAttribute(a,"data-itemid"),i.traverseNode(c,this._findLinkFn,null,null,b),b.linkNode}},{key:"_isParentTocItem",value:function(a){return this.bookNode!==a&&this.that.isTOCItem(a)}},{key:"_findLinkFn",value:function(a){var b=i.getAttribute(a,"data-itemid");return b===this.bookid&&(this.bookFound=!0),!this.bookFound||!this.that.hasTOCItemLink(a)||void 0!==this.linkNode||(this.linkNode=a,!1)}},{key:"nextLevel",value:function(a){var b=void 0;return b=h.parseInt(i.dataset(a,"itemlevel"),0),i.hasClass(a,c)?b:b+1}},{key:"onClick",value:function(a){var b=void 0,c=void 0,d=void 0,e=void 0;if(e=a.currentTarget,b=a.target,c=this.hasLink(b),d=this.getItemNode(b,e),this.isBookNode(d)&&(c&&this.selectedNode!==d&&this.isOpenBook(d)||(this.toggleBook(d,!1),this.updateBreadcrumbInfo(d))),!(!c||this.isUrlNode(d)&&this.hasExternalLink(b)))return this.selectLink(d,!1)}},{key:"selectLink",value:function(a,b,c){if(null==c&&(c=m),this.selectedNode&&i.removeClass(this.selectedNode,w),b&&this.selectedNode!==a&&h.delay(function(){return a.scrollIntoView(!1)},c),this.selectedNode=a,a)return this.updateBreadcrumbInfo(a),i.addClass(a,w)}},{key:"selectTocItem",value:function(a){var b=a.id+"_0";if(b){for(var c={},d=-1;b;)d++,c[b]=!0,b=b.substr(0,b.lastIndexOf("_"));this.widget.publish("show_child",c),this.widget.publish("curlevel",d),a.url&&rh.model.publish("EVT_TOC_LOADEDgototab",{tab:0,item:{url:a.url}})}}},{key:"getItemNode",value:function(a,b){return h.findParentNode(a,b,this.isTOCItem)}},{key:"getChildItemNode",value:function(a,b){return i.find(a,function(a){return"LI"===i.nodeName(a)||i.getAttribute(a,y)})}},{key:"hasTOCItemLink",value:function(a){var b=i.getAttribute(a,"data-haslink");return"true"===b}},{key:"hasLink",value:function(a){var b=void 0;return b=i.getAttribute(a,"href"),b&&"#"!==b}},{key:"isBookNode",value:function(a){return i.hasClass(a,"book")}},{key:"isTopicNode",value:function(a){return i.hasClass(a,"item")}},{key:"isUrlNode",value:function(a){return i.hasClass(a,"url")}},{key:"isPageNode",value:function(a){return this.isTopicNode(a)||this.isUrlNode(a)}},{key:"isOpenBook",value:function(b){return this.widget.get(l)?i.hasClass(b,a):i.hasClass(b,c)}},{key:"hasExternalLink",value:function(a){var b=void 0;return b=i.getAttribute(a,"href"),!(!b||h.isRelativeUrl(b))&&!h.isUrlAllowdInIframe(b)}},{key:"getBookNode",value:function(a,b){var c=void 0;return c=this.getItemNode(a,b),this.isBookNode(c)?c:null}},{key:"animateCollapse",value:function(a){return h.each([a,a.nextElementSibling],function(a){return i.addClass(a,b),h.delay(function(){return i.removeClass(a,b)},m)})}},{key:"animateExpand",value:function(a){return h.each([a,a.nextElementSibling],function(a){return i.addClass(a,o),h.delay(function(){return i.removeClass(a,o)},m)})}},{key:"toggleBook",value:function(a,b){return null==b&&(b=!0),this.isOpenBook(a)?this.closeBook(a):this.openBook(a,b)}},{key:"closeBook",value:function(a){var b=void 0,d=void 0;if(b=i.dataset(a,"itemid"),d=""+t+b,!1!==this.widget.get(d)&&this.widget.publish(d,!1),this.updateActiveBookInfo(this.nextLevel(a),this.pid(b)),this.updateBookInfo(),i.hasClass(a,c))return i.removeClass(a,c),this.animateCollapse(a)}},{key:"openBook",value:function(a,b,d){var e=void 0,f=void 0,g=void 0,h=void 0;return null==d&&(d=this.updateBookInfo),g=i.dataset(a,"itemkey"),f=i.dataset(a,"itemid"),e=i.dataset(a,"childorder"),h=""+t+f,!0!==this.widget.get(h)&&this.widget.publish(h,!0),this.updateActiveBookInfo(this.nextLevel(a),f),this.widget.get(g)?(i.hasClass(a,c)||(i.addClass(a,c),this.animateExpand(a)),d()):(i.addClass(a,v),b&&a.scrollIntoView(!1),this.loadToc(g,e,function(b){return function(){return i.removeClass(a,v),i.addClass(a,c),b.animateExpand(a),d()}}(this)))}},{key:"extractTempData",value:function(){var a=void 0;return a=this.widget.get(rh.consts("KEY_TEMP_DATA")),this.widget.publish(rh.consts("KEY_TEMP_DATA")),a}},{key:"loadToc",value:function(a,b,c){var d=void 0,e=void 0,f=void 0,g=void 0;return g=this.parseKey(a),d=g.absRef,e=g.key,f=d?d+"/":"",h.loadScript(f+"whxdata/"+e+".new.js",!0,function(e){return function(){var f=void 0;return f=e.extractTempData()||[],h.each(f,function(a){if(a.absRef=d,b)return a.childOrder=b}),e.loadRefToc(f,function(b){if(e.widget.publish(a,b),c)return c()})}}(this))}},{key:"loadRefToc",value:function(a,b){var c=void 0,d=void 0,e=void 0;if(null==a&&(a=[]),d=h.findIndex(a,function(a){if(a.ref)return!0}),d!==-1){e=a[d],c=e.absRef||"",c&&(c+="/"),c+=e.ref;var f=j.get(k("KEY_TOC_ORDER")),g=f[c].order;return h.loadScript(c+"/whxdata/toc.new.js",!0,function(e){return function(){var f=void 0;return f=e.extractTempData()||[],h.each(f,function(a){if(a.absRef=c,g)return a.childOrder=g}),Array.prototype.splice.apply(a,[d,1].concat(f)),e.loadRefToc(a,b)}}(this))}if(b)return b(a)}},{key:"getTOCData",value:function(){return j.subscribeOnce(k("KEY_PUBLISH_BASE_URL"),function(a){return function(){var b;try{return j.subscribe(k("KEY_PROJECT_LIST"),function(b){return j.subscribe(k("KEY_MASTER_PROJECT_LIST"),function(c){var d,e;return e=c.length,d=[],h.each(c,function(a){return a=h.makeRelativeUrl(a,b[0]),a&&(a+="/"),h.loadScript(a+"whxdata/toc.new.js",!0,function(b){return function(){var c;return c=b.extractTempData()||[],h.each(c,function(b){b.absRef=a}),b.loadRefToc(c,function(a){if(e--,d=d.concat(a),0===e)return b.widget.publish(u,d),b.widget.publish(k("EVT_TOC_LOADED"),!0),b.widget.subscribe(rh.consts("KEY_TOPIC_ID"),b.subscribeTopicID)})}}(this))},a)})})}catch(c){if(b=c,rh._debug)return rh._d("warn",b.message)}}}(this))}},{key:"nextChildOrder",value:function(a){var b=void 0;return b=a.split("@"),b[b.length-1]=1+h.parseInt(b[b.length-1],0),b.join("@")}},{key:"childOrder",value:function(a){return a?a+"@1":"@1"}},{key:"pid",value:function(a){var b=void 0;return b=a.split("_"),b.pop(),b.join("_")||"_"}},{key:"key",value:function(a,b){var c=void 0;return null==a&&(a=""),c=h.findIndex(this.projectAbsRef,function(b){return b===a}),c===-1&&(c=this.projectAbsRef.length,this.projectAbsRef.push(a)),".p.child_toc."+c+"."+b}},{key:"parseKey",value:function(a){var b=void 0,c=void 0,d=void 0;return a=a.substring(3),c=a.split("."),d=c.pop(),b=this.projectAbsRef[c.pop()]||"",{key:d,absRef:b}}},{key:"url",value:function B(a,b){var c=void 0,d=void 0,e=void 0,f=void 0,B=void 0;return a.url?"remoteitem"===a.type?encodeURI(a.url):(f=a.absRef?h.ensureSlash(a.absRef):"",B=""+f+a.url,c=h.extractHashString(B),c.length>0&&(c="#"+c,d=h.filePath(B),e=h.extractParamString(B),e.length>0&&(e+="&"),e="?"+e+"rhtocid="+b,B=""+d+e+c),encodeURI(B)):"#"}},{key:"tags",value:function(a){var b=void 0;return b=a.absRef?"+"+a.absRef:"",a["data-rhtags"]?a["data-rhtags"]+b:""}},{key:"subscribeTopicID",value:function(a){var b=this,c=void 0,d=void 0;null==a&&(a={}),d=h.hashParams().rhtocid,d?(c=this.getPathfromId(d),this.selectTocById(c,this.widget.node)):rh.model.subscribe(rh.consts("KEY_MASTER_PROJECT_LIST"),function(c){if(c&&c.length<2)return b.syncToc.sync(b,a)})}},{key:"subscribeBookId",value:function(a){var b=void 0,c=void 0;if(a)return c=this.getPathfromId(a),this.selectTocById(c,this.widget.node,null,b)}},{key:"getPathfromId",value:function(a){var b=void 0;return b=a.split("_"),b.shift(),b=h.map(b,function(a){return h.parseInt(a,0)})}},{key:"selectTocById",value:function(a,b,c,d){var e=void 0,f=void 0;if(null==c&&(c=1),b&&b.children&&(f=a.shift(),e=h.find(b.children,function(a){if(this.isBookNode(a)||this.isPageNode(a)){if(0===f)return!0;f--}return!1},this)))return 0===a.length&&this.selectLink(e,!0,c),this.isBookNode(e)?this.openBook(e,!0,function(b){return function(){return h.defer(function(){var c=void 0,d=void 0;return 0===a.length?b.updateBookInfo():(c=e.nextElementSibling,d=c.children&&c.children[0],b.selectTocById(a,d,m))})}}(this)):this.updateBookInfo()}}]),A}();return A.prototype["class"]=function(a){return"remoteitem"===a.type?"url":a.type},A}(),rh.controller("TocController",o)},{"../../src/lib/rh":24,"../../src/responsive_help/utils/node_utils":66}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../src/lib/rh"),f=rh._,g=(rh.$,rh.model),h=rh.consts,i=function(){function a(){var b=this;d(this,a),this.data={"":{order:"",nextChild:0}},g.subscribeOnce(h("KEY_PROJECT_LIST"),function(a){f.each(a,function(c){c=f.makeRelativeUrl(b.trimFirst(c,"."),a[0]),b.childOrder(c)}),g.publish(h("KEY_TOC_ORDER"),b.data)})}return e(a,[{key:"trimFirst",value:function(a,b){return a=a.length&&a[0]===b&&a[1]!==b?a.substring(1):a}},{key:"childOrder",value:function(a){if(a=this.trimFirst(a,"/"),!this.data[a]){var b=a;b=b.substring(0,b.lastIndexOf("/")),b=b.substring(0,b.lastIndexOf("/"));var c=this.data[b];c.nextChild++,this.data[a]={order:c.order+"@"+c.nextChild,nextChild:0}}return this.data[a].order}}]),a}();new i},{"../../src/lib/rh":24}],7:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=window,rh=e.rh,f=rh._,g=(rh.$,function h(){d(this,h);var a=function(a){var b=rh.model.get("t.brsmap");if(null!=b){var c=b.n&&b.n[0]||"",d=b.p&&b.p[0]||"",e=window.decodeURI(document.location.href);return f.isEmptyString(c)||(c=window._getRelativeFileName(e,c)),f.isEmptyString||(d=window._getRelativeFileName(e,d)),rh.model.publish("l.brsBack",d),rh.model.publish("l.brsNext",c)}},b=function(){var a=rh.model.get(rh.consts("KEY_UI_MODE")),b=rh.model.get("l.brsBack"),c=rh.model.get("l.brsNext"),d=!(a||!b&&!c);return rh.model.publish("l.show_brs",d)};rh.model.subscribe("t.topicurl",f.debounce(a,200)),rh.model.subscribe("t.brsmap",f.debounce(a,200)),rh.model.subscribe("l.brsBack",b),rh.model.subscribe("l.brsNext",b),rh.model.subscribe(rh.consts("KEY_UI_MODE"),b)});rh.widgets.BrowseSequenceBuilder=g},{}],8:[function(a,b,c){"use strict";(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,rh,u,v,w;rh=window.rh,h=rh._,a=rh.$,i=rh.consts,r=rh.model,d=i("HASH_KEY_RH_SEARCH"),f=i("HASH_KEY_TOPIC"),g=i("HASH_KEY_UIMODE"),e=i("HASH_KEY_RH_TOCID"),c=i("HASH_KEY_RH_HIGHLIGHT"),b=i("HASH_KEY_RANDOM"),q=[c,i("HASH_KEY_RH_SYNS"),e],m=function(a){var b,c;return c=h.urlParams(h.extractParamString(a)),b=h.hashParams(h.extractHashString(a)),h.extend(c,b)},o=function(a,c){var d,e,f,g,j,k,l;for(c=c,e=h.filePath(c),d=h.extractHashString(c),d.length>0&&(d="#"+d),l=h.urlParams(h.extractParamString(c)),f=0,j=q.length;f<j;f++)g=q[f],null!=a[g]&&(l[g]=a[g]);return r.get(i("KEY_SCREEN_IOS"))&&(l[b]=h.uniqueId()),k=h.mapToEncodedString(l),k.length>0&&(k="?"+k),""+e+k+d},t=h.queueUpdateHashMap,k=function(a){return null==a&&(a={}),a[g]=null,a[b]=null,a[e]||(a[e]=null),a[c]||(a[c]=null),a},j=function(a){return null==a&&(a={}),a[g]||(a[g]=null),a[b]=null,a[e]||(a[e]=null),a[c]||(a[c]=null),a[d]||(a[d]=null),a},v=function(a,b){var c;return a=h.fixRelativeUrl(a),c=h.urlParams(h.extractParamString(a)),c[f]=h.stripParam(a),c=k(c),t(c,b)},l=function(a){var b;return a=h.fixRelativeUrl(a),b=h.urlParams(h.extractParamString(a)),b=j(b)},n=function(a){var b;return b=l(a),h.isEmptyObject(b)?"":"?"+h.mapToEncodedString(b)},u=function(a,b){var c;return c={},c[f]=a,c=k(c),t(c,b)},p=function(a){var b,j,k,l,m,n,p,q,s,t;if(j=a.newMap,k=a.oldMap,m=k[g],t=j[g],d in j&&(p=j[d],q=p!==r.get(i("KEY_SEARCHED_TERM")),r.publish(i("KEY_SEARCH_TERM"),p,{sync:!0})),"search"===t&&q&&window.gHost&&r.publish(i("EVT_QUERY_SEARCH_RESULTS"),!0),!t||j[f]){l=r.get(i("KEY_TOPIC_IN_IFRAME")),f in j&&(s=j[f]),s||(s=l);var u=rh.model.get(rh.consts("KEY_FEATURE"));s||u&&u.showDefTopic===!1||(s=null!=(n=window.gDefaultTopic)?n.substring(1):void 0),b=s&&(s!==l||m!==t||k[c]!==j[c]||k[e]!==j[e]),b&&(h.stripBookmark(s)!==h.stripBookmark(l)&&h.runTopicLoadingAnimation(!0),r.publish(i("KEY_TOPIC_IN_IFRAME"),s),window.loadTopic(o(j,s)))}return r.publish(i("KEY_UI_MODE"),j[g])},w=function(a){var b,c,d,e;if(c=h.hashParams(),a&&!c[g]&&(b=decodeURI(document.location.href),e=window._getRelativeFileName(b,a),d=c[f],!d||h.filePath(e)!==h.filePath(d)))return r.publish(i("KEY_TOPIC_IN_IFRAME"),e),v(e,!1)},s=function(a){var b,c,d,e,f,j;return j=a.absUrl,h.isRootUrl()?h.isUrlAllowdInIframe(j)?(j=h.makeRelativeUrl(h.fixRelativeUrl(j)),b=j&&h.filePath(j),b===i("START_FILEPATH")?j=j.substring(b.length):j||(j="#ux"),"#"===j[0]||"?"===j[0]?(c=h.hashParams(h.extractHashString(j)),g in c||(c[g]=null),t(c,!0)):j?v(j,!0):void 0):u(j,!0):(h.isRootUrl(j)||(f=h.getRootUrl(),h.isExternalUrl(j)?e=j:(d=n(j),e=h.fixRelativeUrl(h.makeRelativePath(j,f))),j=""+f+d+"#t="+encodeURIComponent(e)),document.location.href=j)},r.subscribe(i("EVT_WIDGET_LOADED"),function(){return h.addEventListener(document,"click",h.hookClick),r.subscribe(i("EVT_HASH_CHANGE"),p),r.subscribe(i("KEY_TOPIC_URL"),w),r.subscribe(i("EVT_NAVIGATE_TO_URL"),s),r.subscribe(i("KEY_TOPIC_IN_IFRAME"),function(a){if(""+window.gHost+window.gHostPath!="/"&&(window.setTopic&&window.setTopic(),window.changeTopicLink))return window.changeTopicLink(document.location.toString())}),r.subscribe(i("EVT_TOPIC_LOADED"),function(){return h.runTopicLoadingAnimation(!1)}),r.subscribe(i("EVT_INSIDE_IFRAME_DOM_CONTENTLOADED"),function(){return h.runTopicLoadingAnimation(!1)})})}).call(void 0)},{}],9:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh._,h=(rh.$,rh.consts),i=rh.storage,j=rh._params.filter,k=function(){var a=void 0,b=void 0,c=void 0;return k=function(){function f(a){d(this,f),this.getUnchecked=this.getUnchecked.bind(this),this.handleTagStates=this.handleTagStates.bind(this),i.init(h("HELP_ID")),this.allTagNames=this.computeNames(rh.model.get(h("KEY_MERGED_FILTER_KEY"))),this.prepareTagStates(),this.handleTagStates(rh.model.get(h("KEY_PROJECT_TAG_STATES"))),rh.model.subscribe(h("KEY_PROJECT_TAG_STATES"),g.debounce(this.handleTagStates,300),{initDone:!0})}return e(f,null,[{key:"initClass",value:function(){a=":",b=";",c=","}}]),e(f,[{key:"computeNames",value:function(a){return g.reduce(a,function(a,b){return a.push(b.children?this.computeNames(b.children):b.name),a},[],this)}},{key:"getUnchecked",value:function(a,b){return g.filter(this.allTagNames[a],function(a){return-1===b.indexOf(a)})}},{key:"computeExpression",value:function(a){if(!a||!this.allTagNames)return rh.model.publish(h("KEY_TAG_EXPRESSION"),[]);var b=g.reduce(a,function(a,b,c){if(g.isString(b))a.push({c:[b],u:[]});else if(null!=b){var d=void 0;(d=g.compact(b))&&d.length>0&&a.push({c:d,u:this.getUnchecked(c,d)})}return a},[],this);return rh.model.publish(h("KEY_TAG_EXPRESSION"),b)}},{key:"handleTagStates",value:function(a){return null==a&&(a={}),this.computeExpression(a),i.persist("tag_states",a)}},{key:"prepareTagStates",value:function(){var a=this;return rh.model.subscribe(h("KEY_PROJECT_FILTER_TYPE"),function(){var b=void 0;if(j){var d=rh.model.get(h("KEY_MERGED_FILTER_KEY"));b=a.parseUrlFilter(d,j.split(c))}if(b||(b=i.fetch("tag_states")),b||(b=g.clone(rh.model.get(h("KEY_DEFAULT_FILTER")))),b)return rh.model.publish(h("KEY_PROJECT_TAG_STATES"),b)})}},{key:"parseFilterElemnt",value:function(c,d){var e=d.split(a),f=e[0],h=e[1]&&e[1].split(b),i=g.findIndex(c,function(a){
return null!=h==(null!=a.children)&&a.display===f});return{index:i,elements:h}}},{key:"parseUrlFilter",value:function(a,b){if(b||b.length){var c="radio"===rh.model.get(h("KEY_PROJECT_FILTER_TYPE")),d=!0;return g.reduce(b,function(b,e,f){var g=void 0,h=this.parseFilterElemnt(a,e);if(f=h.index,g=h.elements,f!==-1){var i=a[f];i.children?b[f]=this.parseUrlFilter(i.children,g):c&&!d||(d=!1,b[f]=i.name)}return b},{},this)}}}]),f}(),k.initClass(),k}();rh.widgets.ExpressionBuilder=k},{}],10:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh._,h=rh.$,i=rh.consts,j=function(){var a=void 0,b=void 0,c=void 0;return j=function(){function f(a){d(this,f),this.click=this.click.bind(this),this.widget=a}return e(f,null,[{key:"initClass",value:function(){a="group",b="item",c=i("KEY_PROJECT_FILTER_TYPE")}}]),e(f,[{key:"click",value:function(a){var b=a.currentTarget,c=a.target,d=this.getItemNode(c,b),e=""+i("KEY_PROJECT_TAG_STATES")+this.getItemKey(d),f=this.widget.get(e);return"radio"!==this.filterType()?this.handleCheckboxClick(d,e,f):this.handleRadioClick(d,e,f),g.preventDefault(a)}},{key:"handleRadioClick",value:function(a,b,c){if(!this.isGroupNode(a)&&!c){var d=g.splitKey(b),e=d.parentKey,f=d.key,h={};return h[f]=this.getItemValue(a),this.widget.publish(e,h)}}},{key:"handleCheckboxClick",value:function(a,b,c){var d=void 0;if(this.isGroupNode(a)){var e=g.any(c,function(a){return a});return d=e?void 0:this.getGroupItemExprs(a),this.widget.publish(b,d)}return d=c?void 0:this.getItemValue(a),this.widget.publish(b,d)}},{key:"getItemNode",value:function(a,b){return g.findParentNode(a,b,function(a){return"LI"===h.nodeName(a)})}},{key:"getItemValue",value:function(a){return h.dataset(a,"itemvalue")}},{key:"getGroupItemExprs",value:function(a){var b=h.dataset(a,"itemkey"),c=this.widget.get(""+this.widget.key+b);return g.map(c.children,function(a){return a.name})}},{key:"getItemKey",value:function(a){return h.dataset(a,"itemkey")}},{key:"isGroupNode",value:function(b){return h.hasClass(b,a)}},{key:"isItemNode",value:function(a){return h.hasClass(a,b)}},{key:"class",value:function(c){return c.children?a:b}},{key:"value",value:function(a){return a.children?null:a.name}},{key:"filterType",value:function(){return this.widget.get(c)||"checkbox"}},{key:"inputType",value:function(a){var b=this.filterType();return a.children&&"radio"===b&&(b=void 0),b}}]),f}(),j.initClass(),j}();rh.controller("FilterController",j)},{}],11:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh.model,h=rh._,i=rh.consts,j=rh.http,k=rh.rhs,l=function(){var a=void 0;return l=function(){function b(){d(this,b);var c=3e3;g.subscribeOnce(i("EVT_PROJECT_LOADED"),function(){return g.subscribeOnce(i("KEY_PUBLISH_MODE"),function(b){if(b){var d=d||a(),e=[],f=h.debounce(function(){return j.post(d,JSON.stringify(e)).error(function(a,b){if(rh._debug)return rh._d("error","Filter report status ",b)})},c,!1);return g.subscribe(i("KEY_TAG_EXPRESSION"),function(a){e=[];var b=rh.model.get(i("KEY_MERGED_FILTER_KEY")),c=!0,d=!1,g=void 0;try{for(var h,j=Array.from(a)[Symbol.iterator]();!(c=(h=j.next()).done);c=!0){var k=h.value,l=!0,m=!1,n=void 0;try{for(var o,p=Array.from(k.c)[Symbol.iterator]();!(l=(o=p.next()).done);l=!0){var q,r=o.value;(q=rh.filterObject.lookup(b,r,!1))&&e.push(q.display)}}catch(s){m=!0,n=s}finally{try{!l&&p["return"]&&p["return"]()}finally{if(m)throw n}}}}catch(s){d=!0,g=s}finally{try{!c&&j["return"]&&j["return"]()}finally{if(d)throw g}}if(e.length>0)return f()})}})})}return e(b,null,[{key:"initClass",value:function(){a=function(){var a=document.location.origin,b=g.get(i("KEY_PUBLISH_BASE_URL")).substr(a.length);if(b&&!h.isEmptyString(b)){var c=h.mapToEncodedString(h.extend(h.addPathNameKey({area:k.area(),prj:k.project(),type:k.type(),agt:"fltRpt",mgr:"agm"})));return b+"?"+c}}}}]),b}(),l.initClass(),l}();new l},{}],12:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=window,rh=h.rh,i=rh.model,j=(rh._,rh.consts),k=(rh.http,function(){var a=void 0;return k=function(b){function c(a){d(this,c);var b=e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return b.data=[],b.chunkCount=0,b.count=0,b.keys="",b.alhpabet="",b.loadNavData("glo"),b.filter="",b.widget=a,b.widget.publish("show",{}),b}return f(c,b),g(c,null,[{key:"initClass",value:function(){a="entrys"}}]),g(c,[{key:"addElement",value:function(b,c){var d=this;return function(){var e=[],f=!0,g=!1,h=void 0;try{for(var i,j=Array.from(b[a])[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value;null!=k&&(d.lookup(c,k)?e.push(void 0):e.push(c.push(k)))}}catch(l){g=!0,h=l}finally{try{!f&&j["return"]&&j["return"]()}finally{if(g)throw h}}return e}()}},{key:"exists",value:function(a){var b=this.alphaText(a);return this.alhpabet.indexOf(b)>-1||(this.alhpabet+=b,!1)}},{key:"isFiltered",value:function(a){return this.filter&&a.toLocaleLowerCase().indexOf(this.filter)===-1}},{key:"alphaText",value:function(a){return a.toUpperCase().charAt(0)}},{key:"filterGlo",value:function(a){return this.filter=a.toLocaleLowerCase(),this.alhpabet="",i.publish(j("PROJECT_GLOSSARY_DATA"),i.get(j("PROJECT_GLOSSARY_DATA")))}}]),c}(rh.NavController),k.initClass(),k}());rh.controller("GlossaryController",k)},{}],13:[function(a,b,c){"use strict";(function(){var a,b,c,d,e,f,rh,g,h,i=function(a,b){return function(){return a.apply(b,arguments)}},j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;rh=window.rh,f=rh.model,c=rh._,d=rh.consts,e=rh.http,g=rh.rhs,h="topics",b=function(){function a(){this.updateData=i(this.updateData,this)}return a.prototype.lookup=function(a,b){var d,e,f,g;if(null!=a&&null!=b)for(f=0,g=a.length;f<g&&(d=a[f],null==d||(b.type===d.type&&b.name===d.name&&c.isEqual(b.url,d.url)&&c.isEqual(b[h],d[h])&&(e=d),null==e));f++);return e},a.prototype.sort=function(a){return a.sort(function(a,b){return window.compare(a.name,b.name)})},a.prototype.updateData=function(a,b){var c;if(c=f.get(d("KEY_TEMP_DATA"))||[],f.publish(d("KEY_TEMP_DATA")),this.addElement(c,this.data,b,this.keys),0===--this.chunkCount&&0===this.count)return this.sort(this.data),f.publish(d(a),this.data)},a.prototype.getChunkData=function(a,b){var e,g;return this.count--,e=(null!=(g=f.get(d("KEY_TEMP_DATA")))?g.chunkinfos:void 0)||[],this.chunkCount+=e.length,c.each(e,function(d){return a&&(a=c.ensureSlash(a)),c.loadScript(a+"whxdata/"+d.node+".new.js",!1,function(c){return function(){return c.updateData(b,a)}}(this))},this)},a.prototype.loadNavData=function(a){return f.subscribe(d("KEY_PROJECT_LIST"),function(b){return function(d){return b.alhpabet="",b.count+=d.length,c.each(d,function(b){return b&&(b=c.ensureSlash(b)),c.loadScript(b+"whxdata/"+("ndx"===a?"idx":"glo")+".new.js",!1,function(c){return function(){return c.getChunkData(b,"ndx"===a?"PROJECT_INDEX_DATA":"PROJECT_GLOSSARY_DATA")}}(this))},b)}}(this))},a}(),rh.NavController=b,a=function(a){function b(a){this.data=[],this.chunkCount=0,this.count=0,this.alhpabet="",this.filter="",this.keys="keys",this.widget=a,f.subscribeOnce(d("EVT_PROJECT_LOADED"),function(a){return function(){return a.loadNavData("ndx"),a.getIndexData(),f.subscribe(d("KEY_INDEX_FILTER"),function(){return a.alhpabet="",f.publish(d("PROJECT_INDEX_DATA"),f.get(d("PROJECT_INDEX_DATA")))})}}(this))}var i;return j(b,a),i="",b.prototype.addElement=function(a,b,d,e){var f,g,j,k,l,m,n,o;if(null!=a[e]){for(m=a[e],o=[],j=0,k=m.length;j<k;j++)f=m[j],null!=f&&((g=this.lookup(b,f))||(l={type:f.type,name:f.name},f["data-rhtags"]&&(l["data-rhtags"]=f["data-rhtags"]+"+"+d),f.url||(l[h]=[]),n=c.makeRelativeUrl(""+d,i),null!=f.url&&(l.url=""+encodeURI(n)+f.url),null==f.url&&(l[this.keys]=[]),b.push(l),g=b[b.length-1]),this.addElement(f,g[this.keys],d,this.keys),o.push(this.addElement(f,g[h],d,h)));return o}},b.prototype.showItem=function(a){var b;return b=f.get(d("KEY_INDEX_FILTER")),!b||a.toLocaleLowerCase().indexOf(b.toLocaleLowerCase())!==-1},b.prototype.showCategory=function(a,b){var c;return!(b>0)&&(c=this.alphaText(a),!(this.alhpabet.indexOf(c)>-1)&&(this.alhpabet+=c,!0))},b.prototype.showNextLevel=function(a){var b,c,d,e;for(c=a.getAttribute("data-indexid"),e=this.widget.get("show."+c),d={},d[""+c]=!e,b=d;c;)c=c.substr(0,c.lastIndexOf("_")),b[c]=!0;return this.widget.publish("show",b)},b.prototype.alphaText=function(a){return a.toUpperCase().charAt(0)},b.prototype.getIndexData=function(){return f.subscribeOnce(d("KEY_PUBLISH_BASE_URL"),function(){var a,b,h,i,j,k;try{if(b=f.get(d("KEY_PUBLISH_BASE_URL")),j=document.location.origin,a=b.substr(j.length),k=c.parentPath(c.filePath(c.getRootUrl())),a&&!c.isEmptyString(a))return i=c.mapToEncodedString(c.extend({area:g.area(),prj:g.project(),type:g.type(),agt:"ndx",mgr:"agm"})),e.get(a+"?"+i).success(function(a,b){var e;return a=JSON.parse(a),e=[],c.each(a,function(b){return a[0]=c.ensureSlash(a[0]),e.push(c.makeRelativeUrl(b,a[0]))}),f.publish(d("KEY_PROJECT_LIST"),e)})}catch(l){if(h=l,rh._debug)return rh._d("warn",h.message)}})},b}(rh.NavController),rh.controller("IndexController",a)}).call(void 0)},{}],14:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=(rh.$,rh.consts),g=rh.model;g.publish(f("KEY_SHOW_TAGS"),"true"===rh._params.showtags),g.publish(f("KEY_IFRAME_EVENTS"),{click:!0});var h={},i=function(){var a=e.hashParams();return g.publish(f("EVT_HASH_CHANGE"),{oldMap:h,newMap:a},{sync:!0}),h=a},j=function(){var a=e.extractParamString(document.location.href),b=e.urlParams(a),c=e.extractHashString(document.location.href),d=e.hashParams(c),g=f("RHMAPNO"),h=f("HASH_KEY_TOPIC");if(!(g in b||h in d))return document.location=f("DEFAULT_TOPIC")};e.addEventListener(window,"hashchange",i),e.addEventListener(window,"orientationchange",function(a){if(g.publish(f("EVT_ORIENTATION_CHANGE"),null),g.get(f("KEY_SCREEN_IPAD"))){var b=void 0;if(b=e.getTopicFrame()){var c=b.style.display;return b.style.display="none",b.offsetHeight,e.defer(function(){return b.style.display=c,e.delay(function(){return b.offsetHeight,e.delay(function(){return b.offsetHeight},500)},200)})}}}),g.subscribe(f("EVT_WIDGET_LOADED"),function(){var a=void 0;g.subscribe(f("KEY_MERGED_FILTER_KEY"),function(){return new rh.widgets.ExpressionBuilder}),new rh.widgets.BrowseSequenceBuilder,i(),rh.layoutPrint=window.print,window.print=function(){return g.publish(f("EVT_PRINT_TOPIC"),null)};var b=e.getFileName(document.location.href);if(b===f("TOPIC_FILE")){var c=j();if(c)return c}if(a=e.getTopicFrame())return a.onload=function(){return g.publish(f("EVT_TOPIC_LOADED"),null)};var d=e.extractParamString(document.location.href),h=e.urlParams(d),k=f("RHMAPNO");return k in h?document.location=f("TOPIC_FILE")+"?"+d:void 0}),g.subscribe(f("EVT_BOOKMARK")+"#content_top_placeholder",function(){return g.publish(f("EVT_SCROLL_TO_TOP"),null)}),g.subscribe(f("KEY_PROJECT_LIST"),function(){return rh.filterObject=new rh.MergeProj}),g.subscribe(f("EVT_PROJECT_LOADED"),function(){var a="deviceready";return document.addEventListener(a,function(){if(null!=window.cordova)return g.publish(f("KEY_MOBILE_APP_MODE"),!0)})})},{}],15:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){var rh=void 0,a=void 0,b=void 0;return f=function(){function c(e,f){d(this,c);var g=(null!=f?f.removeClasses:void 0)||["hide-children","loading"];b.each(g,function(b){return a.removeClass(e.node,b)}),b.each(null!=f?f.addClasses:void 0,function(b){return a.addClass(e.node,b)})}return e(c,null,[{key:"initClass",value:function(){var c=window;rh=c.rh;var d=rh;a=d.$;var e=rh;b=e._}}]),c}(),f.initClass(),f}();window.rh.controller("JsLoadingController",f)},{}],16:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=(rh._,rh.$),f=rh.consts;rh.model.subscribe(f("EVT_WIDGET_BEFORELOAD"),function(){if(null!==e("a.wShow",0)){var a=e(".contenttopic",0);return e.setAttribute(a,"data-rhwidget","Basic"),e.setAttribute(a,"data-class","govt_csh:@.l.csh_mode;govt_nocsh:!@.l.csh_mode")}})},{}],17:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh._,h=rh.model,i=rh.consts,j=function(){var a=void 0,b=void 0,c=void 0,f=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0;return j=function(){function j(){d(this,j),a.push("."),b.push("."),o()}return e(j,null,[{key:"initClass",value:function(){a=[],b=[],c="projectdata.js",f="remote",k="project",l="url",m=0,n=function(d){var e=d+"/"+c;return window.xmlJsReader.loadFile(e,function(c,d){var e=void 0,j=0;if(m++,null!=c){var n=c.getElementsByTagName(k)[0];e=n.getElementsByTagName(f),j=e.length}if(g.each(e,function(c){var e=d+"/"+c.getAttribute(l);return a.push(e),b.push(e)}),o(),0===b.length&&m===a.length)return h.publish(i("KEY_PROJECT_LIST"),a),h.publish(i("KEY_MASTER_PROJECT_LIST"),["."])},d)},o=function(){return function(){for(var a=[];b.length>0;){var c=b.splice(0,1);a.push(n(c))}return a}()}}}]),j}(),j.initClass(),j}();h.subscribe(i("EVT_PROJECT_LOADED"),function(){return g.defer(function(){if(!h.get(i("KEY_PUBLISH_MODE"))&&!window.gbPreviewMode)return new j})})},{}],18:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){var rh=void 0,a=void 0,b=void 0,c=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0;return f=function(){function f(a){var b=this;d(this,f),this.triggerDelayLoadWidgets=this.triggerDelayLoadWidgets.bind(this),this.widget=a,this.init(),this.subscribeActiveTab(),this.subscribeToLocations(),this.subscribeScreens(),this.widget.subscribe(c("EVT_PROJECT_LOADED"),function(){return b.subscribeUIMode(),b.subscribeMergedFilter(),b.subscribeTopicClick(),b.subscribeTopicScroll(),b.subscribForSearchResult(),b.subscribeTopicNavigate(),b.subscribeToDelayLoadEvents(),b.widget.publish(c("KEY_IFRAME_EVENTS"),{click:!0,scroll:!1})})}return e(f,null,[{key:"initClass",value:function(){var d=window;rh=d.rh;var e=rh;a=e._;var f=rh;b=f.$;var u=rh;c=u.consts,g=c("KEY_FEATURE"),h=c("KEY_FILTER_LOCATION"),i=c("KEY_SEARCH_LOCATION"),j=c("KEY_ACTIVE_TAB"),k=c("KEY_UI_MODE"),l=c("KEY_MOBILE_TOC_DRILL_DOWN"),m=c("KEY_TOC_DRILL_DOWN"),n="desktop",o="tablet",p="phone",q="filter"!==rh._params.hideUI,r={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo","filter","fts"]},s={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo"]},t={idx:{evt:"EVT_LOAD_IDX",f_key:"delay_load_idx"},glo:{evt:"EVT_LOAD_GLO",f_key:"delay_load_glo"}}}}]),e(f,[{key:"init",value:function(){return this.screens=this.widget.get(c("KEY_SCREEN_NAMES")),rh.storage.init(c("HELP_ID")),this.activeScreen=a.find(this.screens,function(a){return this.widget.get(c("KEY_SCREEN")+"."+a+".attached")},this),null==this.activeScreen&&(this.activeScreen=this.widget.get(c("KEY_DEFAULT_SCREEN"))),this.assureLocations(this.activeScreen),this.initDefauls(),this.initActiveTab()}},{key:"initDefauls",value:function(){var b=this.widget.get(c("KEY_DEFAULT_TAB"));return this.hasFeature(b)||(b=null),this.defaultTabs={},a.each(this.screens,function(c){return r[c]=a.filter(r[c],function(a){return this.hasFeature(a)},this),s[c]=a.filter(s[c],function(a){return this.hasFeature(a)},this),this.defaultTabs[c]=b&&-1!==r[c].indexOf(b)?b:r[c][0]},this)}},{key:"initActiveTab",value:function(){var a=rh.storage.fetch("activetab");if(void 0!==a&&a&&this.hasFeature(a))return this.widget.publish(j,a)}},{key:"isValidTab",value:function(a,b){return null==b&&(b=this.activeScreen),!(!a||!this.hasFeature(a))&&((b!==n||!("filter"===a&&"content"===this.widget.get(h)||"fts"===a&&"content"===this.widget.get(i)))&&-1!==r[b].indexOf(a))}},{key:"defaultTab",value:function u(b){null==b&&(b=this.activeScreen);var u=this.defaultTabs[b];return this.isValidTab(u)||(u=a.find(r[b],function(a){return this.isValidTab(a)},this)),u}},{key:"assureValidActiveTab",value:function(a){null==a&&(a=this.activeScreen);var b=this.widget.get(j);if(a===n||b)return this.isValidTab(b)||(b=this.defaultTab()),this.widget.publish(j,b)}},{key:"toggleSideBar",value:function(){return this.widget.get(j)?this.widget.publish(j,null):this.widget.publish(j,this.lastMobileTab||this.defaultTab())}},{key:"toggleActiveTab",value:function(a){return this.widget.publish(j,this.isDesktopScreen()||a!==this.widget.get(j)?a:null)}},{key:"triggerDelayLoadWidgets",value:function(a){var b=t[a];if(b&&this.hasFeature(b.f_key))return this.widget.publish(c(b.evt),!0)}},{key:"subscribeToDelayLoadEvents",value:function(){return this.widget.subscribe(j,this.triggerDelayLoadWidgets)}},{key:"filterDone",value:function(){return this.widget.publish(j,this.searchMode?"fts":null)}},{key:"hasFeature",value:function(a){return void 0===a||!1!==this.widget.get(g+"."+a)}},{key:"subscribeUIMode",value:function(){var a=this,b=function(){if(a.isValidTab("fts"))return a.isDesktopScreen()&&"tabbar"!==a.widget.get(i)?void 0:a.widget.publish(j,"fts")};if(this.widget.subscribe(k,function(b){return a.widget.publish("active_content",b)}),this.widget.subscribe("active_content",function(c){return a.isMobileScreen()&&!c?a.widget.publish(j,null):"search"===c?b():void 0},{initDone:!0}),"search"===this.widget.get("active_content"))return b()}},{key:"subscribeMergedFilter",value:function(){var a=this,b=void 0;if(this.widget.get(b=g+".filter"))return this.widget.subscribe(c("KEY_MERGED_FILTER_KEY"),function(c){return a.widget.publish(b,!!(c&&c.length&&q)),a.assureValidActiveTab()})}},{key:"subscribeTopicClick",value:function(){var a=this;return this.widget.subscribe(c("EVT_CLICK_INSIDE_IFRAME"),function(){if(a.activeScreen===p&&a.widget.get(j))return a.toggleSideBar()})}},{key:"subscribeTopicNavigate",value:function(){var b=this;return this.widget.subscribe(c("EVT_NAVIGATE_TO_URL"),function(c){if(c.absUrl&&a.isUrlAllowdInIframe(c.absUrl))return b.widget.publish("active_content",null)})}},{key:"subscribeTopicScroll",value:function(){var a=this;return this.widget.subscribe(c("EVT_SCROLL_INSIDE_IFRAME"),function(b){var c="down"===b.dir||b.scrollTop>10;a.widget.publish("hide_header",c);var d="down"===b.dir&&b.scrollTop>10;return a.widget.publish("hide_mobile_functions",d)})}},{key:"subscribeActiveTab",value:function(){var a=this;return this.widget.subscribe(j,function(b){return rh.storage.persist("activetab",b),a.isMobileScreen()?(a.isSidebarTab(b)&&(a.lastMobileTab=b),a.searchMode="fts"===b||a.searchMode&&"filter"===b):a.searchMode=!1})}},{key:"subscribeScreens",value:function(){return a.each(this.screens,function(a){var b=this,d=c("KEY_SCREEN")+"."+a+".attached";return this.widget.get(d)&&this.handleScreen(!0,a),this.widget.subscribe(d,function(c){return b.handleScreen(c,a)},{initDone:!0})},this)}},{key:"subscribeToLocations",value:function(){var a=this;return this.widget.subscribe(i,function(){return a.assureValidActiveTab(a.activeScreen)}),this.widget.subscribe(h,function(){return a.assureValidActiveTab(a.activeScreen)})}},{key:"subscribForSearchResult",value:function(){var b=this,d=function(){var a=b.widget.get(c("KEY_TAG_EXPRESSION")),d=b.widget.get(c("KEY_ONSEARCH_TAG_EXPR"));if(d&&d!==JSON.stringify(a))return b.widget.publish(c("EVT_SEARCH_TERM"),!0)};return this.widget.subscribe(c("KEY_TAG_EXPRESSION"),a.debounce(function(){if((!b.isValidTab("fts")||"fts"===b.widget.get(j))&&b.isSearchMode(b.widget.get(j)))return d()},300)),this.widget.subscribe(j,function(a){if("fts"===a)return d()})}},{key:"isMobileScreen",value:function(){return this.activeScreen===p}},{key:"isDesktopScreen",value:function(){return this.activeScreen===n}},{key:"isTabletScreen",value:function(){return this.activeScreen===o}},{key:"isSidebarTab",value:function(a){return a&&-1!==s[this.activeScreen].indexOf(a)}},{key:"isSearchMode",value:function(a){var b=this.widget.get("active_content");return"fts"===a||"search"===b&&this.isDesktopScreen()&&"content"===this.widget.get(i)}},{key:"handleScreen",value:function(a,b){return a?(this.activeScreen=b,this.handleAttached(b)):this.handleDetached(b)}},{key:"handleDetached",value:function(b){var c=this;return a.defer(function(){if(b===n)return c.widget.publish(j,"search"===c.widget.get("active_content")&&c.isValidTab("fts")?"fts":null)})}},{key:"handleAttached",value:function(a){return this.assureLocations(a),this.assureValidActiveTab(a),this.assureTOCMode(a)}},{key:"assureLocations",value:function(a){return null==a&&(a=this.activeScreen),this.widget.publish(i,a===n?this.widget.get(c("KEY_DEFAULT_SEARCH_LOCATION")):a===o?"tabbar":"content"),this.widget.publish(h,a===n||a===o?"tabbar":"content")}},{key:"assureTOCMode",value:function(a){return null==a&&(a=this.activeScreen),this.widget.publish(m,a!==n&&this.widget.get(l))}},{key:"newSearch",value:function(a,b,d){if(13===b){var e=this.widget.get(c("KEY_SEARCH_TERM"));if(e!==a&&this.widget.publish(c("KEY_SEARCH_TERM"),a),this.widget.publish(c("EVT_SEARCH_TERM"),!0),null!=d?d.target:void 0)return d.target.blur()}}},{key:"isTagStatesChanged",value:function(){var b=a.compactObject(this.widget.get(c("KEY_PROJECT_TAG_STATES"))),d=a.compactObject(this.widget.get(c("KEY_DEFAULT_FILTER")));return!a.isEqual(b,d)}},{key:"setDefaultTagStates",value:function(){var b=this.widget.get(c("KEY_DEFAULT_FILTER"));return this.widget.publish(c("KEY_PROJECT_TAG_STATES"),a.clone(b))}}]),f}(),f.initClass(),f}();window.rh.controller("ModernLayoutController",f)},{}],19:[function(a,b,c){"use strict";(function(){var a,b,c,d,rh;rh=window.rh,d=rh.model,b=rh._,c=rh.consts,a=function(){function a(){this.tagCombs=[],this.idmap={},this.filter=[],this.grpType="group",this.dataLoaded=!1,this.loadTagData(d.get(c("KEY_PROJECT_LIST"))),this.caption=this.type=this.defFilter=void 0}var e,f;return a.prototype.updateTagCombs=function(a){var e,f;if(f=d.get(c("KEY_PROJECT_TAG_COMBINATIONS")),null!=f)return a=b.parseProjectName(a),null!=(e=this.idmap)[a]?e[a]:e[a]=f},a.prototype.lookup=function(a,b,c){var d,e,f,g,h;if(null==c&&(c=!0),null!=a&&null!=b)for(g=0,h=a.length;g<h&&(d=a[g],null==d||(e=d.name||d.display,c===(null!=d.children)&&e===b?f=d:null==d.children||c||(f=this.lookup(d.children,b,c)),null==f));g++);return f},e=function(a){var b;return b={type:"group",display:a,children:[]}},a.prototype.addTag=function(a,b){var c;if(null==this.lookup(this.filter,b.name,!1))return c={display:b.display,name:b.name},a.push(c)},a.prototype.addGroup=function(a){var b,c,d,f,g;for(c=this.lookup(this.filter,a.display),null==c&&(c=e(a.display),this.filter.push(c)),g=a.children,d=0,f=g.length;d<f;d++)b=g[d],null!=b&&null==b.children&&this.addTag(c.children,b);if(0===c.children.length&&this.filter.indexOf(c)>-1)return this.filter.splice(this.filter.indexOf(c),1)},a.prototype.updateFilter=function(){var a,b,e,f,g;for(a=d.get(c("KEY_TEMP_DATA"))||[],this.caption||(this.caption=a.caption),this.type||(this.type=a.type),"undefined"==typeof this.defFilter&&(this.defFilter=a["default"]),a=a.tags||[],d.publish(c("KEY_TEMP_DATA")),g=[],e=0,f=a.length;e<f;e++)b=a[e],null!=b&&(null!=b.children?g.push(this.addGroup(b)):g.push(this.addTag(this.filter,b)));return g},f=function(a,b){if(this.updateTagCombs(a),this.updateFilter(),!b)return d.publish(c("KEY_MERGED_FILTER_KEY"),this.filter),d.publish(c("KEY_MERGED_PROJECT_MAP"),this.idmap),d.publish(c("KEY_PROJECT_FILTER_CAPTION"),this.caption),d.publish(c("KEY_PROJECT_FILTER_TYPE"),this.type),d.publish(c("KEY_DEFAULT_FILTER"),this.defFilter),this.dataLoaded=!0},a.prototype.loadTagData=function(a){var d,e,g,h,i;if(!this.dataLoaded){for(d=a.length,i=[],e=0,g=a.length;e<g;e++)h=a[e],null!=h?(h&&(h+="/"),i.push(b.loadScript(""+h+c("PATH_PROJECT_TAGDATA_FILE"),!1,f.bind(this,h,--d)))):i.push(void 0);return i}},a}(),rh.MergeProj=a}).call(void 0)},{}],20:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=(rh.$,rh.consts),g=rh.model,h=rh.rhs,i=null;i=g.subscribe(f("KEY_TAG_EXPRESSION"),function(){var a=!1;return function(){if(i&&i(),!a)return a=!0,g.subscribe(f("KEY_SEARCHED_TERM"),function(){return g.publish(f("KEY_ONSEARCH_TAG_EXPR"),JSON.stringify(g.get(f("KEY_TAG_EXPRESSION"))))})}}()),g.subscribe(f("EVT_SEARCH_TERM"),function(){var a=g.get(f("KEY_CAN_HANDLE_SEARCH")),b=g.get(f("KEY_SEARCH_TERM"))||null,c={};return c[f("HASH_KEY_RH_SEARCH")]=b,c[f("HASH_KEY_UIMODE")]="search",a!==!0?document.location=window.gRootRelPath+"/"+(window.gSearchPageFilePath||f("START_FILEPATH"))+("?#"+e.mapToEncodedString(c)):(g.publish(f("EVT_QUERY_SEARCH_RESULTS"),!0),e.defer(function(){return e.updateHashMap(c,!0)}))}),g.subscribe(f("EVT_PROJECT_LOADED"),function(){return window.readSetting&&window.readSetting(RHANDSEARCH,function(a){return g.publish(f("KEY_AND_SEARCH"),a)}),g.subscribe(f("KEY_AND_SEARCH"),function(a){return saveSetting(RHANDSEARCH,"1"===a?"1":"0",!0)})}),g.subscribe(f("EVT_QUERY_SEARCH_RESULTS"),function(){if(!h.doSearch())return window.doSearch()})},{}],21:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=rh.$,g=rh.consts,h=rh.model;e.getRootUrl=function(){var a=null;return function(){return null!=a?a:a=""+e.getHostFolder()+g("START_FILEPATH")}}(),e.runTopicLoadingAnimation=function(){var a=null,b=!1;return function(c){return b=c,c?(null==a&&(a=e.debounce(function(){return h.publish(g("EVT_TOPIC_LOADING"),b)},700)),a()):(a=null,h.publish(g("EVT_TOPIC_LOADING"),!1))}}(),e.getTopicFrame=function(){var a=window.gTopicFrameName||"rh_default_topic_frame_name";return f("[name="+a+"]",0)}},{}],22:[function(a,b,c){"use strict";null==String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),null==String.prototype.trimStart&&(String.prototype.trimStart=String.prototype.trimLeft),null==String.prototype.trimEnd&&(String.prototype.trimEnd=String.prototype.trimRight)},{}],23:[function(a,b,c){!function(){var a=function(b){var c=new a.Builder;return c.pipeline.add(a.trimmer,a.stopWordFilter,a.stemmer),c.searchPipeline.add(a.stemmer),b.call(c,c),c.build()};a.version="2.3.1",a.utils={},a.utils.warn=function(a){return function(b){a.console&&console.warn&&console.warn(b)}}(this),a.utils.asString=function(a){return void 0===a||null===a?"":a.toString()},a.utils.clone=function(a){if(null===a||void 0===a)return a;for(var b=Object.create(null),c=Object.keys(a),d=0;d<c.length;d++){var e=c[d],f=a[e];if(Array.isArray(f))b[e]=f.slice();else{if("string"!=typeof f&&"number"!=typeof f&&"boolean"!=typeof f)throw new TypeError("clone is not deep and does not support nested objects");b[e]=f}}return b},a.FieldRef=function(a,b,c){this.docRef=a,this.fieldName=b,this._stringValue=c},a.FieldRef.joiner="/",a.FieldRef.fromString=function(b){var c=b.indexOf(a.FieldRef.joiner);if(c===-1)throw"malformed field ref string";var d=b.slice(0,c),e=b.slice(c+1);return new a.FieldRef(e,d,b)},a.FieldRef.prototype.toString=function(){return void 0==this._stringValue&&(this._stringValue=this.fieldName+a.FieldRef.joiner+this.docRef),this._stringValue},a.Set=function(a){if(this.elements=Object.create(null),a){this.length=a.length;for(var b=0;b<this.length;b++)this.elements[a[b]]=!0}else this.length=0},a.Set.complete={intersect:function(a){return a},union:function(a){return a},contains:function(){return!0}},a.Set.empty={intersect:function(){return this},union:function(a){return a},contains:function(){return!1}},a.Set.prototype.contains=function(a){return!!this.elements[a]},a.Set.prototype.intersect=function(b){var c,d,e,f=[];if(b===a.Set.complete)return this;if(b===a.Set.empty)return b;this.length<b.length?(c=this,d=b):(c=b,d=this),e=Object.keys(c.elements);for(var g=0;g<e.length;g++){var h=e[g];h in d.elements&&f.push(h)}return new a.Set(f)},a.Set.prototype.union=function(b){return b===a.Set.complete?a.Set.complete:b===a.Set.empty?this:new a.Set(Object.keys(this.elements).concat(Object.keys(b.elements)))},a.idf=function(a,b){var c=0;for(var d in a)"_index"!=d&&(c+=Object.keys(a[d]).length);var e=(b-c+.5)/(c+.5);return Math.log(1+Math.abs(e))},a.Token=function(a,b){this.str=a||"",this.metadata=b||{}},a.Token.prototype.toString=function(){return this.str},a.Token.prototype.update=function(a){return this.str=a(this.str,this.metadata),this},a.Token.prototype.clone=function(b){return b=b||function(a){return a},new a.Token(b(this.str,this.metadata),this.metadata)},a.tokenizer=function(b,c){if(null==b||void 0==b)return[];if(Array.isArray(b))return b.map(function(b){return new a.Token(a.utils.asString(b).toLowerCase(),a.utils.clone(c))});for(var d=b.toString().trim().toLowerCase(),e=d.length,f=[],g=0,h=0;g<=e;g++){var i=d.charAt(g),j=g-h;if(i.match(a.tokenizer.separator)||g==e){if(j>0){var k=a.utils.clone(c)||{};k.position=[h,j],k.index=f.length,f.push(new a.Token(d.slice(h,g),k))}h=g+1}}return f},a.tokenizer.separator=/[\s\-]+/,a.Pipeline=function(){this._stack=[]},a.Pipeline.registeredFunctions=Object.create(null),a.Pipeline.registerFunction=function(b,c){c in this.registeredFunctions&&a.utils.warn("Overwriting existing registered function: "+c),b.label=c,a.Pipeline.registeredFunctions[b.label]=b},a.Pipeline.warnIfFunctionNotRegistered=function(b){var c=b.label&&b.label in this.registeredFunctions;c||a.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",b)},a.Pipeline.load=function(b){var c=new a.Pipeline;return b.forEach(function(b){var d=a.Pipeline.registeredFunctions[b];if(!d)throw new Error("Cannot load unregistered function: "+b);c.add(d)}),c},a.Pipeline.prototype.add=function(){var b=Array.prototype.slice.call(arguments);b.forEach(function(b){a.Pipeline.warnIfFunctionNotRegistered(b),this._stack.push(b)},this)},a.Pipeline.prototype.after=function(b,c){a.Pipeline.warnIfFunctionNotRegistered(c);
var d=this._stack.indexOf(b);if(d==-1)throw new Error("Cannot find existingFn");d+=1,this._stack.splice(d,0,c)},a.Pipeline.prototype.before=function(b,c){a.Pipeline.warnIfFunctionNotRegistered(c);var d=this._stack.indexOf(b);if(d==-1)throw new Error("Cannot find existingFn");this._stack.splice(d,0,c)},a.Pipeline.prototype.remove=function(a){var b=this._stack.indexOf(a);b!=-1&&this._stack.splice(b,1)},a.Pipeline.prototype.run=function(a){for(var b=this._stack.length,c=0;c<b;c++){for(var d=this._stack[c],e=[],f=0;f<a.length;f++){var g=d(a[f],f,a);if(void 0!==g&&""!==g)if(g instanceof Array)for(var h=0;h<g.length;h++)e.push(g[h]);else e.push(g)}a=e}return a},a.Pipeline.prototype.runString=function(b,c){var d=new a.Token(b,c);return this.run([d]).map(function(a){return a.toString()})},a.Pipeline.prototype.reset=function(){this._stack=[]},a.Pipeline.prototype.toJSON=function(){return this._stack.map(function(b){return a.Pipeline.warnIfFunctionNotRegistered(b),b.label})},a.Vector=function(a){this._magnitude=0,this.elements=a||[]},a.Vector.prototype.positionForIndex=function(a){if(0==this.elements.length)return 0;for(var b=0,c=this.elements.length/2,d=c-b,e=Math.floor(d/2),f=this.elements[2*e];d>1&&(f<a&&(b=e),f>a&&(c=e),f!=a);)d=c-b,e=b+Math.floor(d/2),f=this.elements[2*e];return f==a?2*e:f>a?2*e:f<a?2*(e+1):void 0},a.Vector.prototype.insert=function(a,b){this.upsert(a,b,function(){throw"duplicate index"})},a.Vector.prototype.upsert=function(a,b,c){this._magnitude=0;var d=this.positionForIndex(a);this.elements[d]==a?this.elements[d+1]=c(this.elements[d+1],b):this.elements.splice(d,0,a,b)},a.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var a=0,b=this.elements.length,c=1;c<b;c+=2){var d=this.elements[c];a+=d*d}return this._magnitude=Math.sqrt(a)},a.Vector.prototype.dot=function(a){for(var b=0,c=this.elements,d=a.elements,e=c.length,f=d.length,g=0,h=0,i=0,j=0;i<e&&j<f;)g=c[i],h=d[j],g<h?i+=2:g>h?j+=2:g==h&&(b+=c[i+1]*d[j+1],i+=2,j+=2);return b},a.Vector.prototype.similarity=function(a){return this.dot(a)/this.magnitude()||0},a.Vector.prototype.toArray=function(){for(var a=new Array(this.elements.length/2),b=1,c=0;b<this.elements.length;b+=2,c++)a[c]=this.elements[b];return a},a.Vector.prototype.toJSON=function(){return this.elements},a.stemmer=function(){var a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},b={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},c="[^aeiou]",d="[aeiouy]",e=c+"[^aeiouy]*",f=d+"[aeiou]*",g="^("+e+")?"+f+e,h="^("+e+")?"+f+e+"("+f+")?$",i="^("+e+")?"+f+e+f+e,j="^("+e+")?"+d,k=new RegExp(g),l=new RegExp(i),m=new RegExp(h),n=new RegExp(j),o=/^(.+?)(ss|i)es$/,p=/^(.+?)([^s])s$/,q=/^(.+?)eed$/,r=/^(.+?)(ed|ing)$/,s=/.$/,t=/(at|bl|iz)$/,u=new RegExp("([^aeiouylsz])\\1$"),v=new RegExp("^"+e+d+"[^aeiouwxy]$"),w=/^(.+?[^aeiou])y$/,x=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,y=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,z=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,A=/^(.+?)(s|t)(ion)$/,B=/^(.+?)e$/,C=/ll$/,D=new RegExp("^"+e+d+"[^aeiouwxy]$"),E=function(c){var d,e,f,g,h,i,j;if(c.length<3)return c;if(f=c.substr(0,1),"y"==f&&(c=f.toUpperCase()+c.substr(1)),g=o,h=p,g.test(c)?c=c.replace(g,"$1$2"):h.test(c)&&(c=c.replace(h,"$1$2")),g=q,h=r,g.test(c)){var E=g.exec(c);g=k,g.test(E[1])&&(g=s,c=c.replace(g,""))}else if(h.test(c)){var E=h.exec(c);d=E[1],h=n,h.test(d)&&(c=d,h=t,i=u,j=v,h.test(c)?c+="e":i.test(c)?(g=s,c=c.replace(g,"")):j.test(c)&&(c+="e"))}if(g=w,g.test(c)){var E=g.exec(c);d=E[1],c=d+"i"}if(g=x,g.test(c)){var E=g.exec(c);d=E[1],e=E[2],g=k,g.test(d)&&(c=d+a[e])}if(g=y,g.test(c)){var E=g.exec(c);d=E[1],e=E[2],g=k,g.test(d)&&(c=d+b[e])}if(g=z,h=A,g.test(c)){var E=g.exec(c);d=E[1],g=l,g.test(d)&&(c=d)}else if(h.test(c)){var E=h.exec(c);d=E[1]+E[2],h=l,h.test(d)&&(c=d)}if(g=B,g.test(c)){var E=g.exec(c);d=E[1],g=l,h=m,i=D,(g.test(d)||h.test(d)&&!i.test(d))&&(c=d)}return g=C,h=l,g.test(c)&&h.test(c)&&(g=s,c=c.replace(g,"")),"y"==f&&(c=f.toLowerCase()+c.substr(1)),c};return function(a){return a.update(E)}}(),a.Pipeline.registerFunction(a.stemmer,"stemmer"),a.generateStopWordFilter=function(a){var b=a.reduce(function(a,b){return a[b]=b,a},{});return function(a){if(a&&b[a.toString()]!==a.toString())return a}},a.stopWordFilter=a.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),a.Pipeline.registerFunction(a.stopWordFilter,"stopWordFilter"),a.trimmer=function(a){return a.update(function(a){return a.replace(/^\W+/,"").replace(/\W+$/,"")})},a.Pipeline.registerFunction(a.trimmer,"trimmer"),a.TokenSet=function(){this["final"]=!1,this.edges={},this.id=a.TokenSet._nextId,a.TokenSet._nextId+=1},a.TokenSet._nextId=1,a.TokenSet.fromArray=function(b){for(var c=new a.TokenSet.Builder,d=0,e=b.length;d<e;d++)c.insert(b[d]);return c.finish(),c.root},a.TokenSet.fromClause=function(b){return"editDistance"in b?a.TokenSet.fromFuzzyString(b.term,b.editDistance):a.TokenSet.fromString(b.term)},a.TokenSet.fromFuzzyString=function(b,c){for(var d=new a.TokenSet,e=[{node:d,editsRemaining:c,str:b}];e.length;){var f=e.pop();if(f.str.length>0){var g,h=f.str.charAt(0);h in f.node.edges?g=f.node.edges[h]:(g=new a.TokenSet,f.node.edges[h]=g),1==f.str.length?g["final"]=!0:e.push({node:g,editsRemaining:f.editsRemaining,str:f.str.slice(1)})}if(f.editsRemaining>0&&f.str.length>1){var i,h=f.str.charAt(1);h in f.node.edges?i=f.node.edges[h]:(i=new a.TokenSet,f.node.edges[h]=i),f.str.length<=2?i["final"]=!0:e.push({node:i,editsRemaining:f.editsRemaining-1,str:f.str.slice(2)})}if(f.editsRemaining>0&&1==f.str.length&&(f.node["final"]=!0),f.editsRemaining>0&&f.str.length>=1){if("*"in f.node.edges)var j=f.node.edges["*"];else{var j=new a.TokenSet;f.node.edges["*"]=j}1==f.str.length?j["final"]=!0:e.push({node:j,editsRemaining:f.editsRemaining-1,str:f.str.slice(1)})}if(f.editsRemaining>0){if("*"in f.node.edges)var k=f.node.edges["*"];else{var k=new a.TokenSet;f.node.edges["*"]=k}0==f.str.length?k["final"]=!0:e.push({node:k,editsRemaining:f.editsRemaining-1,str:f.str})}if(f.editsRemaining>0&&f.str.length>1){var l,m=f.str.charAt(0),n=f.str.charAt(1);n in f.node.edges?l=f.node.edges[n]:(l=new a.TokenSet,f.node.edges[n]=l),1==f.str.length?l["final"]=!0:e.push({node:l,editsRemaining:f.editsRemaining-1,str:m+f.str.slice(2)})}}return d},a.TokenSet.fromString=function(b){for(var c=new a.TokenSet,d=c,e=!1,f=0,g=b.length;f<g;f++){var h=b[f],i=f==g-1;if("*"==h)e=!0,c.edges[h]=c,c["final"]=i;else{var j=new a.TokenSet;j["final"]=i,c.edges[h]=j,c=j,e&&(c.edges["*"]=d)}}return d},a.TokenSet.prototype.toArray=function(){for(var a=[],b=[{prefix:"",node:this}];b.length;){var c=b.pop(),d=Object.keys(c.node.edges),e=d.length;c.node["final"]&&(c.prefix.charAt(0),a.push(c.prefix));for(var f=0;f<e;f++){var g=d[f];b.push({prefix:c.prefix.concat(g),node:c.node.edges[g]})}}return a},a.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var a=this["final"]?"1":"0",b=Object.keys(this.edges).sort(),c=b.length,d=0;d<c;d++){var e=b[d],f=this.edges[e];a=a+e+f.id}return a},a.TokenSet.prototype.intersect=function(b){for(var c=new a.TokenSet,d=void 0,e=[{qNode:b,output:c,node:this}];e.length;){d=e.pop();for(var f=Object.keys(d.qNode.edges),g=f.length,h=Object.keys(d.node.edges),i=h.length,j=0;j<g;j++)for(var k=f[j],l=0;l<i;l++){var m=h[l];if(m==k||"*"==k){var n=d.node.edges[m],o=d.qNode.edges[k],p=n["final"]&&o["final"],q=void 0;m in d.output.edges?(q=d.output.edges[m],q["final"]=q["final"]||p):(q=new a.TokenSet,q["final"]=p,d.output.edges[m]=q),e.push({qNode:o,output:q,node:n})}}}return c},a.TokenSet.Builder=function(){this.previousWord="",this.root=new a.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},a.TokenSet.Builder.prototype.insert=function(b){var c,d=0;if(b<this.previousWord)throw new Error("Out of order word insertion");for(var e=0;e<b.length&&e<this.previousWord.length&&b[e]==this.previousWord[e];e++)d++;this.minimize(d),c=0==this.uncheckedNodes.length?this.root:this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(var e=d;e<b.length;e++){var f=new a.TokenSet,g=b[e];c.edges[g]=f,this.uncheckedNodes.push({parent:c,"char":g,child:f}),c=f}c["final"]=!0,this.previousWord=b},a.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},a.TokenSet.Builder.prototype.minimize=function(a){for(var b=this.uncheckedNodes.length-1;b>=a;b--){var c=this.uncheckedNodes[b],d=c.child.toString();d in this.minimizedNodes?c.parent.edges[c["char"]]=this.minimizedNodes[d]:(c.child._str=d,this.minimizedNodes[d]=c.child),this.uncheckedNodes.pop()}},a.Index=function(a){this.invertedIndex=a.invertedIndex,this.fieldVectors=a.fieldVectors,this.tokenSet=a.tokenSet,this.fields=a.fields,this.pipeline=a.pipeline},a.Index.prototype.search=function(b){return this.query(function(c){var d=new a.QueryParser(b,c);d.parse()})},a.Index.prototype.query=function(b){for(var c=new a.Query(this.fields),d=Object.create(null),e=Object.create(null),f=Object.create(null),g=Object.create(null),h=Object.create(null),i=0;i<this.fields.length;i++)e[this.fields[i]]=new a.Vector;b.call(c,c);for(var i=0;i<c.clauses.length;i++){var j=c.clauses[i],k=null,l=a.Set.complete;k=j.usePipeline?this.pipeline.runString(j.term,{fields:j.fields}):[j.term];for(var m=0;m<k.length;m++){var n=k[m];j.term=n;var o=a.TokenSet.fromClause(j),p=this.tokenSet.intersect(o).toArray();if(0===p.length&&j.presence===a.Query.presence.REQUIRED){for(var q=0;q<j.fields.length;q++){var r=j.fields[q];g[r]=a.Set.empty}break}for(var s=0;s<p.length;s++)for(var t=p[s],u=this.invertedIndex[t],v=u._index,q=0;q<j.fields.length;q++){var r=j.fields[q],w=u[r],x=Object.keys(w),y=t+"/"+r,z=new a.Set(x);if(j.presence==a.Query.presence.REQUIRED&&(l=l.union(z),void 0===g[r]&&(g[r]=a.Set.complete)),j.presence!=a.Query.presence.PROHIBITED){if(e[r].upsert(v,j.boost,function(a,b){return a+b}),!f[y]){for(var A=0;A<x.length;A++){var B,C=x[A],D=new a.FieldRef(C,r),E=w[C];void 0===(B=d[D])?d[D]=new a.MatchData(t,r,E):B.add(t,r,E)}f[y]=!0}}else void 0===h[r]&&(h[r]=a.Set.empty),h[r]=h[r].union(z)}}if(j.presence===a.Query.presence.REQUIRED)for(var q=0;q<j.fields.length;q++){var r=j.fields[q];g[r]=g[r].intersect(l)}}for(var F=a.Set.complete,G=a.Set.empty,i=0;i<this.fields.length;i++){var r=this.fields[i];g[r]&&(F=F.intersect(g[r])),h[r]&&(G=G.union(h[r]))}var H=Object.keys(d),I=[],J=Object.create(null);if(c.isNegated()){H=Object.keys(this.fieldVectors);for(var i=0;i<H.length;i++){var D=H[i],K=a.FieldRef.fromString(D);d[D]=new a.MatchData}}for(var i=0;i<H.length;i++){var K=a.FieldRef.fromString(H[i]),L=K.docRef;if(F.contains(L)&&!G.contains(L)){var M,N=this.fieldVectors[K],O=e[K.fieldName].similarity(N);if(void 0!==(M=J[L]))M.score+=O,M.matchData.combine(d[K]);else{var P={ref:L,score:O,matchData:d[K]};J[L]=P,I.push(P)}}}return I.sort(function(a,b){return b.score-a.score})},a.Index.prototype.toJSON=function(){var b=Object.keys(this.invertedIndex).sort().map(function(a){return[a,this.invertedIndex[a]]},this),c=Object.keys(this.fieldVectors).map(function(a){return[a,this.fieldVectors[a].toJSON()]},this);return{version:a.version,fields:this.fields,fieldVectors:c,invertedIndex:b,pipeline:this.pipeline.toJSON()}},a.Index.load=function(b){var c={},d={},e=b.fieldVectors,f={},g=b.invertedIndex,h=new a.TokenSet.Builder,i=a.Pipeline.load(b.pipeline);b.version!=a.version&&a.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+a.version+"' does not match serialized index '"+b.version+"'");for(var j=0;j<e.length;j++){var k=e[j],l=k[0],m=k[1];d[l]=new a.Vector(m)}for(var j=0;j<g.length;j++){var k=g[j],n=k[0],o=k[1];h.insert(n),f[n]=o}return h.finish(),c.fields=b.fields,c.fieldVectors=d,c.invertedIndex=f,c.tokenSet=h.root,c.pipeline=i,new a.Index(c)},a.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=a.tokenizer,this.pipeline=new a.Pipeline,this.searchPipeline=new a.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},a.Builder.prototype.ref=function(a){this._ref=a},a.Builder.prototype.field=function(a,b){if(/\//.test(a))throw new RangeError("Field '"+a+"' contains illegal character '/'");this._fields[a]=b||{}},a.Builder.prototype.b=function(a){a<0?this._b=0:a>1?this._b=1:this._b=a},a.Builder.prototype.k1=function(a){this._k1=a},a.Builder.prototype.add=function(b,c){var d=b[this._ref],e=Object.keys(this._fields);this._documents[d]=c||{},this.documentCount+=1;for(var f=0;f<e.length;f++){var g=e[f],h=this._fields[g].extractor,i=h?h(b):b[g],j=this.tokenizer(i,{fields:[g]}),k=this.pipeline.run(j),l=new a.FieldRef(d,g),m=Object.create(null);this.fieldTermFrequencies[l]=m,this.fieldLengths[l]=0,this.fieldLengths[l]+=k.length;for(var n=0;n<k.length;n++){var o=k[n];if(void 0==m[o]&&(m[o]=0),m[o]+=1,void 0==this.invertedIndex[o]){var p=Object.create(null);p._index=this.termIndex,this.termIndex+=1;for(var q=0;q<e.length;q++)p[e[q]]=Object.create(null);this.invertedIndex[o]=p}void 0==this.invertedIndex[o][g][d]&&(this.invertedIndex[o][g][d]=Object.create(null));for(var r=0;r<this.metadataWhitelist.length;r++){var s=this.metadataWhitelist[r],t=o.metadata[s];void 0==this.invertedIndex[o][g][d][s]&&(this.invertedIndex[o][g][d][s]=[]),this.invertedIndex[o][g][d][s].push(t)}}}},a.Builder.prototype.calculateAverageFieldLengths=function(){for(var b=Object.keys(this.fieldLengths),c=b.length,d={},e={},f=0;f<c;f++){var g=a.FieldRef.fromString(b[f]),h=g.fieldName;e[h]||(e[h]=0),e[h]+=1,d[h]||(d[h]=0),d[h]+=this.fieldLengths[g]}for(var i=Object.keys(this._fields),f=0;f<i.length;f++){var j=i[f];d[j]=d[j]/e[j]}this.averageFieldLength=d},a.Builder.prototype.createFieldVectors=function(){for(var b={},c=Object.keys(this.fieldTermFrequencies),d=c.length,e=Object.create(null),f=0;f<d;f++){for(var g=a.FieldRef.fromString(c[f]),h=g.fieldName,i=this.fieldLengths[g],j=new a.Vector,k=this.fieldTermFrequencies[g],l=Object.keys(k),m=l.length,n=this._fields[h].boost||1,o=this._documents[g.docRef].boost||1,p=0;p<m;p++){var q,r,s,t=l[p],u=k[t],v=this.invertedIndex[t]._index;void 0===e[t]?(q=a.idf(this.invertedIndex[t],this.documentCount),e[t]=q):q=e[t],r=q*((this._k1+1)*u)/(this._k1*(1-this._b+this._b*(i/this.averageFieldLength[h]))+u),r*=n,r*=o,s=Math.round(1e3*r)/1e3,j.insert(v,s)}b[g]=j}this.fieldVectors=b},a.Builder.prototype.createTokenSet=function(){this.tokenSet=a.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},a.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new a.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},a.Builder.prototype.use=function(a){var b=Array.prototype.slice.call(arguments,1);b.unshift(this),a.apply(this,b)},a.MatchData=function(a,b,c){for(var d=Object.create(null),e=Object.keys(c||{}),f=0;f<e.length;f++){var g=e[f];d[g]=c[g].slice()}this.metadata=Object.create(null),void 0!==a&&(this.metadata[a]=Object.create(null),this.metadata[a][b]=d)},a.MatchData.prototype.combine=function(a){for(var b=Object.keys(a.metadata),c=0;c<b.length;c++){var d=b[c],e=Object.keys(a.metadata[d]);void 0==this.metadata[d]&&(this.metadata[d]=Object.create(null));for(var f=0;f<e.length;f++){var g=e[f],h=Object.keys(a.metadata[d][g]);void 0==this.metadata[d][g]&&(this.metadata[d][g]=Object.create(null));for(var i=0;i<h.length;i++){var j=h[i];void 0==this.metadata[d][g][j]?this.metadata[d][g][j]=a.metadata[d][g][j]:this.metadata[d][g][j]=this.metadata[d][g][j].concat(a.metadata[d][g][j])}}}},a.MatchData.prototype.add=function(a,b,c){if(!(a in this.metadata))return this.metadata[a]=Object.create(null),void(this.metadata[a][b]=c);if(!(b in this.metadata[a]))return void(this.metadata[a][b]=c);for(var d=Object.keys(c),e=0;e<d.length;e++){var f=d[e];f in this.metadata[a][b]?this.metadata[a][b][f]=this.metadata[a][b][f].concat(c[f]):this.metadata[a][b][f]=c[f]}},a.Query=function(a){this.clauses=[],this.allFields=a},a.Query.wildcard=new String("*"),a.Query.wildcard.NONE=0,a.Query.wildcard.LEADING=1,a.Query.wildcard.TRAILING=2,a.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},a.Query.prototype.clause=function(b){return"fields"in b||(b.fields=this.allFields),"boost"in b||(b.boost=1),"usePipeline"in b||(b.usePipeline=!0),"wildcard"in b||(b.wildcard=a.Query.wildcard.NONE),b.wildcard&a.Query.wildcard.LEADING&&b.term.charAt(0)!=a.Query.wildcard&&(b.term="*"+b.term),b.wildcard&a.Query.wildcard.TRAILING&&b.term.slice(-1)!=a.Query.wildcard&&(b.term=""+b.term+"*"),"presence"in b||(b.presence=a.Query.presence.OPTIONAL),this.clauses.push(b),this},a.Query.prototype.isNegated=function(){for(var b=0;b<this.clauses.length;b++)if(this.clauses[b].presence!=a.Query.presence.PROHIBITED)return!1;return!0},a.Query.prototype.term=function(b,c){if(Array.isArray(b))return b.forEach(function(b){this.term(b,a.utils.clone(c))},this),this;var d=c||{};return d.term=b.toString(),this.clause(d),this},a.QueryParseError=function(a,b,c){this.name="QueryParseError",this.message=a,this.start=b,this.end=c},a.QueryParseError.prototype=new Error,a.QueryLexer=function(a){this.lexemes=[],this.str=a,this.length=a.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},a.QueryLexer.prototype.run=function(){for(var b=a.QueryLexer.lexText;b;)b=b(this)},a.QueryLexer.prototype.sliceString=function(){for(var a=[],b=this.start,c=this.pos,d=0;d<this.escapeCharPositions.length;d++)c=this.escapeCharPositions[d],a.push(this.str.slice(b,c)),b=c+1;return a.push(this.str.slice(b,this.pos)),this.escapeCharPositions.length=0,a.join("")},a.QueryLexer.prototype.emit=function(a){this.lexemes.push({type:a,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},a.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},a.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return a.QueryLexer.EOS;var b=this.str.charAt(this.pos);return this.pos+=1,b},a.QueryLexer.prototype.width=function(){return this.pos-this.start},a.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},a.QueryLexer.prototype.backup=function(){this.pos-=1},a.QueryLexer.prototype.acceptDigitRun=function(){var b,c;do b=this.next(),c=b.charCodeAt(0);while(c>47&&c<58);b!=a.QueryLexer.EOS&&this.backup()},a.QueryLexer.prototype.more=function(){return this.pos<this.length},a.QueryLexer.EOS="EOS",a.QueryLexer.FIELD="FIELD",a.QueryLexer.TERM="TERM",a.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",a.QueryLexer.BOOST="BOOST",a.QueryLexer.PRESENCE="PRESENCE",a.QueryLexer.lexField=function(b){return b.backup(),b.emit(a.QueryLexer.FIELD),b.ignore(),a.QueryLexer.lexText},a.QueryLexer.lexTerm=function(b){if(b.width()>1&&(b.backup(),b.emit(a.QueryLexer.TERM)),b.ignore(),b.more())return a.QueryLexer.lexText},a.QueryLexer.lexEditDistance=function(b){return b.ignore(),b.acceptDigitRun(),b.emit(a.QueryLexer.EDIT_DISTANCE),a.QueryLexer.lexText},a.QueryLexer.lexBoost=function(b){return b.ignore(),b.acceptDigitRun(),b.emit(a.QueryLexer.BOOST),a.QueryLexer.lexText},a.QueryLexer.lexEOS=function(b){b.width()>0&&b.emit(a.QueryLexer.TERM)},a.QueryLexer.termSeparator=a.tokenizer.separator,a.QueryLexer.lexText=function(b){for(;;){var c=b.next();if(c==a.QueryLexer.EOS)return a.QueryLexer.lexEOS;if(92!=c.charCodeAt(0)){if(":"==c)return a.QueryLexer.lexField;if("~"==c)return b.backup(),b.width()>0&&b.emit(a.QueryLexer.TERM),a.QueryLexer.lexEditDistance;if("^"==c)return b.backup(),b.width()>0&&b.emit(a.QueryLexer.TERM),a.QueryLexer.lexBoost;if("+"==c&&1===b.width())return b.emit(a.QueryLexer.PRESENCE),a.QueryLexer.lexText;if("-"==c&&1===b.width())return b.emit(a.QueryLexer.PRESENCE),a.QueryLexer.lexText;if(c.match(a.QueryLexer.termSeparator))return a.QueryLexer.lexTerm}else b.escapeCharacter()}},a.QueryParser=function(b,c){this.lexer=new a.QueryLexer(b),this.query=c,this.currentClause={},this.lexemeIdx=0},a.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var b=a.QueryParser.parseClause;b;)b=b(this);return this.query},a.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},a.QueryParser.prototype.consumeLexeme=function(){var a=this.peekLexeme();return this.lexemeIdx+=1,a},a.QueryParser.prototype.nextClause=function(){var a=this.currentClause;this.query.clause(a),this.currentClause={}},a.QueryParser.parseClause=function(b){var c=b.peekLexeme();if(void 0!=c)switch(c.type){case a.QueryLexer.PRESENCE:return a.QueryParser.parsePresence;case a.QueryLexer.FIELD:return a.QueryParser.parseField;case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:var d="expected either a field or a term, found "+c.type;throw c.str.length>=1&&(d+=" with value '"+c.str+"'"),new a.QueryParseError(d,c.start,c.end)}},a.QueryParser.parsePresence=function(b){var c=b.consumeLexeme();if(void 0!=c){switch(c.str){case"-":b.currentClause.presence=a.Query.presence.PROHIBITED;break;case"+":b.currentClause.presence=a.Query.presence.REQUIRED;break;default:var d="unrecognised presence operator'"+c.str+"'";throw new a.QueryParseError(d,c.start,c.end)}var e=b.peekLexeme();if(void 0==e){var d="expecting term or field, found nothing";throw new a.QueryParseError(d,c.start,c.end)}switch(e.type){case a.QueryLexer.FIELD:return a.QueryParser.parseField;case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:var d="expecting term or field, found '"+e.type+"'";throw new a.QueryParseError(d,e.start,e.end)}}},a.QueryParser.parseField=function(b){var c=b.consumeLexeme();if(void 0!=c){if(b.query.allFields.indexOf(c.str)==-1){var d=b.query.allFields.map(function(a){return"'"+a+"'"}).join(", "),e="unrecognised field '"+c.str+"', possible fields: "+d;throw new a.QueryParseError(e,c.start,c.end)}b.currentClause.fields=[c.str];var f=b.peekLexeme();if(void 0==f){var e="expecting term, found nothing";throw new a.QueryParseError(e,c.start,c.end)}switch(f.type){case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:var e="expecting term, found '"+f.type+"'";throw new a.QueryParseError(e,f.start,f.end)}}},a.QueryParser.parseTerm=function(b){var c=b.consumeLexeme();if(void 0!=c){b.currentClause.term=c.str.toLowerCase(),c.str.indexOf("*")!=-1&&(b.currentClause.usePipeline=!1);var d=b.peekLexeme();if(void 0==d)return void b.nextClause();switch(d.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;case a.QueryLexer.PRESENCE:return b.nextClause(),a.QueryParser.parsePresence;default:var e="Unexpected lexeme type '"+d.type+"'";throw new a.QueryParseError(e,d.start,d.end)}}},a.QueryParser.parseEditDistance=function(b){var c=b.consumeLexeme();if(void 0!=c){var d=parseInt(c.str,10);if(isNaN(d)){var e="edit distance must be numeric";throw new a.QueryParseError(e,c.start,c.end)}b.currentClause.editDistance=d;var f=b.peekLexeme();if(void 0==f)return void b.nextClause();switch(f.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;default:var e="Unexpected lexeme type '"+f.type+"'";throw new a.QueryParseError(e,f.start,f.end)}}},a.QueryParser.parseBoost=function(b){var c=b.consumeLexeme();if(void 0!=c){var d=parseInt(c.str,10);if(isNaN(d)){var e="boost must be numeric";throw new a.QueryParseError(e,c.start,c.end)}b.currentClause.boost=d;var f=b.peekLexeme();if(void 0==f)return void b.nextClause();switch(f.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;default:var e="Unexpected lexeme type '"+f.type+"'";throw new a.QueryParseError(e,f.start,f.end)}}},function(a,d){"function"==typeof define&&define.amd?define(d):"object"==typeof c?b.exports=d():a.lunr=d()}(this,function(){return a})}()},{}],24:[function(a,b,c){(function(a){"use strict";void 0===a.rh&&(a.rh={}),b.exports=a.rh}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this._callback=b,this._count=0}return e(a,[{key:"signal",value:function(){this._count++,this._count>=0&&this._callback&&this._callback()}},{key:"wait",value:function(a){var b=a||1;this._count-=b}}]),a}();b.exports=f},{}],26:[function(a,b,c){"use strict";a("../lib/rh"),a("../../lenient_src/utils/shim"),a("../../lenient_src/robohelp/layout/url_utils"),a("../../lenient_src/robohelp/layout/init"),a("../../lenient_src/robohelp/layout/mp"),a("../../lenient_src/robohelp/layout/expression_builder"),a("../../lenient_src/robohelp/layout/browsesequence_builder"),a("../../lenient_src/robohelp/layout/event_handlers"),a("../../lenient_src/robohelp/layout/search_filed"),a("../../lenient_src/robohelp/layout/layoutfix"),a("../../lenient_src/robohelp/layout/filter_controller"),a("../../lenient_src/robohelp/layout/modern_layout_controller"),a("../../lenient_src/robohelp/layout/js_loading_controller"),a("../../lenient_src/robohelp/layout/index_controller"),a("../../lenient_src/robohelp/layout/glossary_controller"),a("../../lenient_src/robohelp/layout/filter_handler"),a("../../lenient_src/robohelp/layout/load_projects"),a("./layout/ui/carousel"),a("./layout/home_controller"),a("../../lenient_src/layout/search_util"),a("./layout/search/suggestion/search_controller"),a("./layout/favorites_controller"),a("./layout/toc_breadcrumbs_controller.js"),a("../../lenient_src/layout/toc_order"),a("../../lenient_src/layout/toc_controller"),a("../../lenient_src/layout/index_controller"),a("../../lenient_src/layout/glossary_controller"),a("../../lenient_src/layout/event_handlers"),a("./layout/rh2017layoutcontroller"),a("./layout/modal_dialog"),a("./layout/search_result_controller.js"),a("../../lenient_src/robohelp/layout/filter_handler"),a("./layout/custom_buttons"),a("./layout/expand_all")},{"../../lenient_src/layout/event_handlers":1,"../../lenient_src/layout/glossary_controller":2,"../../lenient_src/layout/index_controller":3,"../../lenient_src/layout/search_util":4,"../../lenient_src/layout/toc_controller":5,"../../lenient_src/layout/toc_order":6,"../../lenient_src/robohelp/layout/browsesequence_builder":7,"../../lenient_src/robohelp/layout/event_handlers":8,"../../lenient_src/robohelp/layout/expression_builder":9,"../../lenient_src/robohelp/layout/filter_controller":10,"../../lenient_src/robohelp/layout/filter_handler":11,"../../lenient_src/robohelp/layout/glossary_controller":12,"../../lenient_src/robohelp/layout/index_controller":13,"../../lenient_src/robohelp/layout/init":14,"../../lenient_src/robohelp/layout/js_loading_controller":15,"../../lenient_src/robohelp/layout/layoutfix":16,"../../lenient_src/robohelp/layout/load_projects":17,"../../lenient_src/robohelp/layout/modern_layout_controller":18,"../../lenient_src/robohelp/layout/mp":19,"../../lenient_src/robohelp/layout/search_filed":20,"../../lenient_src/robohelp/layout/url_utils":21,"../../lenient_src/utils/shim":22,"../lib/rh":24,"./layout/custom_buttons":27,"./layout/expand_all":28,"./layout/favorites_controller":29,"./layout/home_controller":30,"./layout/modal_dialog":31,"./layout/rh2017layoutcontroller":32,"./layout/search/suggestion/search_controller":49,"./layout/search_result_controller.js":63,"./layout/toc_breadcrumbs_controller.js":64,"./layout/ui/carousel":65}],27:[function(a,b,c){"use strict";var rh=a("../../lib/rh"),d=rh.consts,e=rh.model,f=rh._;e.subscribe(d("KEY_CUSTOM_BUTTONS_CONFIG"),function(a){var b=f.map(a,function(a,b){return f.extend({"class":"custom-button-"+b},a)});e.publish(d("KEY_CUSTOM_BUTTONS"),b)})},{"../../lib/rh":24}],28:[function(a,b,c){"use strict";var rh=a("../../lib/rh");rh.model.csubscribe("EVT_EXPAND_COLLAPSE_ALL",function(){var a=rh.model.cget("ALL_ARE_EXPANDED");a?rh.model.cpublish("EVT_COLLAPSE_ALL"):rh.model.cpublish("EVT_EXPAND_ALL")}),rh.model.csubscribe("EVT_COLLAPSE_ALL",function(){rh.model.cpublish("ALL_ARE_EXPANDED",!1)}),rh.model.csubscribe("EVT_EXPAND_ALL",function(){rh.model.cpublish("ALL_ARE_EXPANDED",!0)})},{"../../lib/rh":24}],29:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh.consts,g=function(){function a(b){var c=this;d(this,a),this.widget=b,this.favStorage=new rh.Storage,this._loadFromStorage=!1,this._favMemoryStore=void 0,rh.model.subscribeOnce(f("EVT_PROJECT_LOADED"),function(){c.init()})}return e(a,[{key:"_getUniqueId",value:function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return a()+a(!0)+a(!0)+a()}},{key:"numberOfItems",value:function(a){return Object.keys(a).length}},{key:"_getFavHTMLElements",value:function(a){for(var b=document.getElementsByTagName("div"),c=[],d=0;d<b.length;d++)b[d].getAttribute(rh.consts("FAVATTRIBUTE"))===a&&c.push(b[d]);return c}},{key:"getLinkTitle",value:function(a){var b=rh.model.get(f("KEY_LNG"));return a?b&&b.unsetAsFavorite||"":b&&b.setAsFavorite||""}},{key:"_loadFavoritesFromStorage",value:function(){var a=void 0,b=this.favStorage.fetch(f("FAVSTORAGE"));return a="undefined"==typeof b||null===b?{}:JSON.parse(b)}},{key:"_loadFavorites",value:function(){return this._loadFromStorage===!1&&(this._favMemoryStore=this._loadFavoritesFromStorage()),this._favMemoryStore}},{key:"_saveFavorites",value:function(){var a=void 0;a=JSON.stringify(this._favMemoryStore),this.favStorage.persist(rh.consts("FAVSTORAGE"),a)}},{key:"_unFavoriteTopic",value:function(a){for(var b in this._favMemoryStore){var c=this._favMemoryStore[b];if(c.topic===a){delete this._favMemoryStore[b];break}}this._saveFavorites(),rh.model.publish(rh.consts("EVENTFAVCHANGE"),null);
}},{key:"_favoriteTopic",value:function(a,b){this._favMemoryStore[this._getUniqueId()]={topic:a,title:b},this._saveFavorites(),rh.model.publish(rh.consts("EVENTFAVCHANGE"),null)}},{key:"getStorageId",value:function(){return"fav-"+rh._.getHostFolder()}},{key:"getTopicURL",value:function(){return rh.model.get(rh.consts("KEY_TOPIC_URL"))}},{key:"getTopicTitle",value:function(){return rh.model.get(rh.consts("KEY_TOPIC_TITLE"))}},{key:"isTopicFavorite",value:function(a){var b=void 0,c=void 0;a||(a=this.getTopicURL()),b=this._loadFavorites(),c=!1;for(var d in b){var e=b[d];if(e.topic===a){c=!0;break}}return c}},{key:"setfavoritesTitle",value:function(a){var b=this.getLinkTitle(a);rh.model.publish(f("FAVORITES_BUTTON_TITLE"),b)}},{key:"setTopicFavoriteState",value:function(){rh.model.publish(f("TOPIC_FAVORITE"),this.isTopicFavorite())}},{key:"setFavoritesList",value:function(){var a=[],b=void 0,c=this._loadFavorites();for(b in c)a.push(c[b]);rh.model.publish(f("KEY_FAVORITES"),a)}},{key:"toggleFavorite",value:function(a){a||(a=this.getTopicURL()),this.isTopicFavorite(a)?this._unFavoriteTopic(a):this._favoriteTopic(a,this.getTopicTitle()),this.setTopicFavoriteState()}},{key:"init",value:function(){this.favStorage.init(rh._.getRootUrl()),rh.model.subscribe(rh.consts("KEY_TOPIC_URL"),this.setTopicFavoriteState.bind(this)),rh.model.subscribe(rh.consts("EVENTFAVCHANGE"),this.setFavoritesList.bind(this)),rh.model.subscribe(rh.consts("TOPIC_FAVORITE"),this.setfavoritesTitle.bind(this)),this.setFavoritesList(),rh.model.publish(f("TOPIC_FAVORITE"),this.isTopicFavorite())}}]),a}();rh.controller("FavoritesController",g)},{"../../lib/rh":24}],30:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh._,g=function(){function a(b){d(this,a),this.widget=b}return e(a,[{key:"goToHome",value:function(a){if(rh.consts("HOME_FILEPATH")===rh._.getFileName())return this.changeToDefaultTopic(a);var b=void 0;return void 0!==a&&""!==a&&(b={rhtocid:a}),f.goToHome(b),!0}},{key:"changeToDefaultTopic",value:function(a){var b={t:window.gDefaultTopic.substring(1)};return void 0!==a&&""!==a&&(b.rhtocid=a),f.queueUpdateHashMap(b,!0),!0}}]),a}();rh.controller("HomeController",g)},{"../../lib/rh":24}],31:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=a("../utils/node_utils"),g=rh.$,h=rh._,i=function(){function a(){d(this,a)}return e(a,[{key:"createChildWidget",value:function(){this.node=g.createElement("div",this.template),f.appendChild(document.body,this.node),this.widget=new rh.Widget({node:this.node}),this.widget.init()}},{key:"setOnImageLoad",value:function(){var a=g.find(this.node,".rh-modal-content")[0];if(a){this.modalContent=a;var b=g.find(a,"img")[0];b&&(this.img=b,b.addEventListener("load",this.setModalSize.bind(this)),b.addEventListener("error",this.setModalSize.bind(this)))}}},{key:"setModalSize",value:function(){this.imageWidth=this.img.naturalWidth,this.imageHeight=this.img.naturalHeight;var a=this.calculatePosition(this.imageWidth,this.imageHeight),b=g.find(this.node,".rh-modal-container")[0];b&&this.setContainerStyle(b,a)}},{key:"setContainerStyle",value:function(a,b){var c=Math.round(b.top),d=Math.round(b.left);g.css(a,"left",d.toString()+"px"),g.css(a,"top",c.toString()+"px"),this.modalContent&&this.setImageSize(b.width,b.height),g.css(a,"display","block")}},{key:"calculateImageSize",value:function(a){var b=a.imageWidth/a.imageHeight;return a.imageWidth<a.pageWidth&&a.imageHeight<a.pageHeight?{width:a.imageWidth,height:a.imageHeight}:a.imageWidth>=a.pageWidth&&a.imageHeight<=a.pageHeight?{height:a.pageWidth/b,width:a.pageWidth}:a.imageWidth<=a.pageWidth&&a.imageHeight>=a.pageHeight?{height:a.pageHeight,width:a.pageHeight*b}:a.imageWidth>=a.pageWidth&&a.imageHeight>=a.pageHeight?this._calculateFullyExceedSize(a,b):void 0}},{key:"_calculateFullyExceedSize",value:function(a,b){var c=a.pageWidth/a.pageHeight;return b<c?{height:a.pageHeight,width:a.pageHeight*b}:{height:a.pageWidth/b,width:a.pageWidth}}},{key:"calculatePosition",value:function(a,b){var c=window.innerWidth||document.body.clientWidth,d=window.innerHeight||document.body.clientHeight;c-=70,d-=70,c=c>=0?c:0,d=d>=0?d:0;var e={imageWidth:a,imageHeight:b,pageWidth:c,pageHeight:d},f=this.calculateImageSize(e);a=f.width,b=f.height;var g=Math.max(5,(c-a)/2),h=Math.max(5,(d-b)/2);return{left:g,top:h,width:a,height:b,pageWidth:c,pageHeight:d}}},{key:"initialStyle",value:function(){return this.isImage?'style="display:none"':""}},{key:"ShowModal",value:function(a){this.isImage=a.isImage,this.createChildWidget(),this.widget.subscribe("close",this._close.bind(this)),this.widget.publish("content",a.content),h.defer(this.setOnImageLoad.bind(this))}},{key:"setImageSize",value:function(a,b){this.imageWidth>a&&g.css(this.img,"width",Math.round(a)+"px"),this.imageHeight>b&&g.css(this.img,"height",Math.round(b)+"px")}},{key:"_close",value:function(){this.widget.destruct(),this.widget=void 0,f.removeChild(this.node),this.node=void 0}},{key:"template",get:function(){var a=this.initialStyle();return'\n    <div class="rh-modal">\n        <div class="rh-modal-container" '+a+'>\n          <div class="rh-modal-content" data-html="content"></div>\n          <div class="rh-modal-close" data-click="@close(true)"> </div>\n        </div>\n    </div>'}}]),a}();rh.model.csubscribe("SHOW_MODAL",function(a){var b=new i;b.ShowModal(a)})},{"../../lib/rh":24,"../utils/node_utils":66}],32:[function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),g=rh.$,h=rh._,i=rh.consts,j=function(){function a(b){e(this,a),this.widget=b,this.topicFrame=".topic-container iframe",this.initLayout(),this.initModal()}return f(a,[{key:"isLayoutMode",value:function(a){var b=a||h.hashParams(),c=b[rh.consts("HASH_KEY_TOPIC")];return b[rh.consts("HASH_KEY_UIMODE")]!==i("HELP_SEARCH_MODE")&&(!c||"true"===b[rh.consts("HASH_HOMEPAGE_MODE")]||b[rh.consts("HASH_KEY_RH_TOCID")])}},{key:"initLayout",value:function(){var a=this;rh.model.subscribe(i("EVT_HASH_CHANGE"),function(b){var c=b.newMap,e=b.oldMap;a.isLayoutMode()?a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_LAYOUT_MODE")):"search"===c[rh.consts("HASH_KEY_UIMODE")]?(a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_SEARCH_MODE")),h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),!1),!1)):a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_TOPIC_MODE"));var f=rh.model.get(rh.consts("KEY_FEATURE"));f&&f.showDefTopic===!1&&!c[rh.consts("HASH_KEY_RH_TOCID")]&&!e[rh.consts("HASH_KEY_TOPIC")]&&c[rh.consts("HASH_KEY_TOPIC")]?h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),"false"),!1):e[rh.consts("HASH_KEY_TOPIC")]&&!c[rh.consts("HASH_KEY_RH_TOCID")]&&e[rh.consts("HASH_KEY_TOPIC")]!==c[rh.consts("HASH_KEY_TOPIC")]&&"true"===c[rh.consts("HASH_HOMEPAGE_MODE")]&&e[rh.consts("HASH_HOMEPAGE_MODE")]===c[rh.consts("HASH_HOMEPAGE_MODE")]&&h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),"false"),!1)});var b=h.hashParams();this.isLayoutMode()&&"true"!==b[rh.consts("HASH_HOMEPAGE_MODE")]&&h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),!0),!1),rh.model.subscribe("EVT_TOC_LOADEDgototab",function(b){b.key&&rh.model.subscribe(b.key,function(a,c,d){d(),b.item&&b.item.url&&!a[0].added&&(a.unshift({type:"item",url:b.item.url,name:b.item.name,added:!0}),rh.model.publish(b.key,a))}),b.item.url&&a.viewTopicInLayoutMode(b.item.url)})}},{key:"viewTopicInLayoutMode",value:function(a){var b=d({homepage:"true"},rh.consts("HASH_KEY_RH_TOCID"),!0);a&&"#"!==a&&(b.t=a),h.queueUpdateHashMap(b,!1)}},{key:"initModal",value:function(){var a=!1;document.addEventListener("keydown",function(a){27===a.keyCode&&rh._.each(g.find(".modal"),function(a){g.addClass(a,"rh-hide")})},!1),document.addEventListener("click",function(){a||rh._.each(g.find(".modal"),function(a){g.addClass(a,"rh-hide")}),a=!1}),rh._.each(g.find(".modal-content"),function(b){h.addEventListener(b,"click",function(){a=!0})})}}]),a}();rh.controller("RH2017LayoutController",j)},{"../../lib/rh":24}],33:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;d(this,a),this._items=b,this._max_items=c}return e(a,[{key:"merge",value:function(a){var b=this;f.each(a,function(a){b.mergeItem(a)}),this._sort(),this._purge()}},{key:"clear",value:function(){this._items=[]}},{key:"_purge",value:function(){this._items.length>this._max_items&&this._items.splice(this._max_items)}},{key:"mergeItem",value:function(a){var b=this.find_item(a);b?b.merge(a):this._items.push(a)}},{key:"find_item",value:function(a){return f.find(this._items,function(b){return b.match(a)})}},{key:"merge_item",value:function(a,b){a.probability+=b.probability,a.count=Math.max(a.count,b.count)}},{key:"_sort",value:function(){this.items.sort(this.compare_items)}},{key:"compare_items",value:function(a,b){return a.compare(b)}},{key:"items",get:function(){return this._items}}]),a}();b.exports=g},{"../../../../lib/rh":24}],34:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh.consts,g=function(){function a(b){d(this,a),this._path=b||"",this.initPath()}return e(a,[{key:"initPath",value:function(){"."===this._path&&(this._path=""),"."===this._path[0]&&"/"===this._path[1]&&(this._path=this._path.slice(2))}},{key:"_getModelFileName",value:function(a){return f("SEARCH_MODEL_ADDR")+a.toString()+".js"}},{key:"getModelFilePath",value:function(a){var b=this._getModelFileName(a);return this._getRelativePath(b)}},{key:"_getRelativePath",value:function(a){var b=""===this._path?a:this._path+"/"+a;return b}},{key:"_getPathKey",value:function(){return""===this._path?"":"_"+this._path+"_"}},{key:"getModelKey",value:function(a){return f("SEARCH_MODEL_KEY")+this._getPathKey()+a.toString()}},{key:"_getMapFileName",value:function(){return f("SEARCH_MAP_ADDR")}},{key:"getMapFilePath",value:function(){var a=this._getMapFileName();return this._getRelativePath(a)}},{key:"getIndexFilePath",value:function(){var a=f("SEARCH_INDEX_FILE");return this._getRelativePath(a)}},{key:"getTopicUrl",value:function(a){return this._getRelativePath(a)}},{key:"getSearchDbFilePath",value:function(){var a=f("SEARCH_DB_FILE");return this._getRelativePath(a)}},{key:"getMetadataFilePath",value:function(){var a=f("SEARCH_METADATA_FILE");return this._getRelativePath(a)}},{key:"getTextFilePath",value:function(a){var b=f("SEARCH_TEXT_FILE"),c=this._getRelativePath(b);return c+"/"+a+".js"}}]),a}();b.exports=g},{"../../../../lib/rh":24}],35:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._;b.exports=function(){function a(b){d(this,a),this.synonymns=b||[],this.rootWords={},this.merge()}return e(a,[{key:"merge",value:function(){var a=this;this.rootWords={},f.each(this.synonymns,function(b){var c=b.words,d=b.name;f.each(c,function(b){a._add(d,b)})})}},{key:"_add",value:function(a,b){b=b.toLowerCase(),a=a.toLowerCase(),this.rootWords[b]=this.rootWords[a]||a}},{key:"getRoot",value:function(a){return this.rootWords[a]||a}}]),a}()},{"../../../../lib/rh":24}],36:[function(a,b,c){"use strict";var d={minPreviousThreshold:.2,previousnGram:1,max_predictions:5,PREDICTOR_SOURCE_ID:{HISTORY_PREDICTOR:0,NGRAM_PREDICTOR:1,GENERAL_PREDICTOR:2,CORRECTOR:3}};b.exports=d},{}],37:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./indices"),rh=a("../../../../lib/rh"),g=rh._,h=a("./prediction"),i=a("./consts"),j=a("./utils"),k=a("./prediction_list"),l=function(){function a(b,c){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;d(this,a),this._loader=b,this.predictions=[],this.max_predictions=e,this._callback=c}return e(a,[{key:"getCorrections",value:function(a){this._parsed_input=a,this.predictions=[],this._computePredictions();var b=this._loader.getHashes(this._parsed_input._partial);if(b)for(var c=b.length,d=0;d<c&&this.predictions.length<this.max_predictions;d++){var e=b[d];this._addCorrection(e)}this.onResultCalculated()}},{key:"clear",value:function(){this.predictions=[]}},{key:"_computePredictions",value:function(){var a=this._loader.getHashes(this._parsed_input._partial);a&&this._addCorrection(a)}},{key:"onResultCalculated",value:function(){this._callback&&this._callback(new k(this.predictions,this._parsed_input),this._loader)}},{key:"_matchCorrection",value:function(a){return this._hamming_dist=this._getDistance(a),this._hamming_dist<=2&&!this._loader.isStopWord(a)}},{key:"_addCorrection",value:function(a){if(a){var b=j.getSafeElement(a,f.MAP.WORD);if(b&&this._matchCorrection(b)){var c=this._parsed_input.replaceLastWord(b),d=this._parsed_input.completeSuggestion(c),e=new h(d,1/this._hamming_dist,2,i.PREDICTOR_SOURCE_ID.CORRECTOR);this.predictions.push(e)}}}},{key:"_getDistance",value:function(a){return g.findEditDist(this._parsed_input._partial,a)}}]),a}();b.exports=l},{"../../../../lib/rh":24,"./consts":36,"./indices":41,"./prediction":45,"./prediction_list":47,"./utils":52}],38:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./prediction_list"),g=a("./prediction_creator"),h=a("./consts"),i=a("./indices"),rh=a("../../../../lib/rh"),j=rh._,k=a("../common/merger"),l=function(){function a(b,c){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;d(this,a),this._max_predictions=e,this._loader=c,this.total_count=this._loader.getTotalCount(),this._callback=b,this._source=h.PREDICTOR_SOURCE_ID.GENERAL_PREDICTOR,this.prediction_merger=new k([],5*this.total_count)}return e(a,[{key:"clear",value:function(){this.prediction_merger.clear(),this.parsed_input=void 0}},{key:"getPredictions",value:function(a){this._init(a),this._computePredictions(),this._onResultComputed()}},{key:"_computePredictions",value:function(){var a=this._getWordHashes();a&&this._addPredictions(a)}},{key:"_isWholeWordInput",value:function(){return this.parsed_input.isWholeWord}},{key:"_getWordHashes",value:function(){return this.parsed_input.isWholeWord?this._loader.top_words:this._loader.getHashes(this.parsed_input._partial)}},{key:"_init",value:function(a){this.prediction_merger=new k([],5*this.total_count),this.parsed_input=a}},{key:"_onResultComputed",value:function(){this._callback&&this._callback(new f(this.predictions,this.parsed_input),this._loader)}},{key:"_addPredictions",value:function(a){if(a)for(var b=a.length,c=0;c<b&&this.predictions.length<this.max_predictions;c++){var d=a[c];this._addWordPrediction(d)}}},{key:"_addWordPrediction",value:function(a,b){b=b||this._matches_partially.bind(this);var c=this._loader.getModelData(a),d=this._loader.total_count;if(b(a)){var e=a[i.MAP.WORD];this._should_add_prediction(e)&&this._create_predictions(a,d,c)}}},{key:"_continueFn",value:function(){return!0}},{key:"_should_add_prediction",value:function(a){return!this._loader.isStopWord(a)&&!this.parsed_input.equalLastWord(a)}},{key:"_matches_partially",value:function(a){if(this.parsed_input.isWholeWord)return!0;var b=a[i.MAP.WORD];return this.parsed_input.comparePartial(b)}},{key:"_create_predictions",value:function(a,b,c){var d=this,e=new g({loader:this._loader,model_item:c,total_count:b,parsed_input:this.parsed_input,continueFn:this._continueFn}),f=e.getMultiPredictions(a,!0,void 0,this._source);j.each(f,function(a){void 0!==a&&d.prediction_merger.mergeItem(a)})}},{key:"_calculate_probability",value:function(a){return a/this.total_count}},{key:"predictions",get:function(){return this.prediction_merger.items}},{key:"max_predictions",set:function(a){this._max_predictions=a},get:function(){return this._max_predictions}}]),a}();b.exports=l},{"../../../../lib/rh":24,"../common/merger":33,"./consts":36,"./indices":41,"./prediction_creator":46,"./prediction_list":47}],39:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=a("./prediction"),h=a("./input_parser"),i=a("./prediction_list"),j=a("./consts"),k=function(){function a(b,c){d(this,a),this._reader=b,this._predictions=[],this._callback=c,this._source=j.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR,this._max_predictions=void 0===j._max_history_predictions?2:j._max_history_predictions}return e(a,[{key:"getPredictions",value:function(a){return this._predictions=[],this._parsed_input=a,this._computePredictions(),this._callback&&this._callback(new i(this._predictions,this._parsed_input)),this._predictions}},{key:"init",value:function(){}},{key:"clear",value:function(){this._predictions=[]}},{key:"_computePredictions",value:function(){var a=this;""!==this._parsed_input.trimmedText&&(f.each(this._reader._list,function(b){a._match(b.text)&&a._predictions.push(a._createPrediction(b))}),this._purge())}},{key:"_purge",value:function(){this._predictions.splice(this._max_predictions)}},{key:"_createPrediction",value:function(a){var b=new g(a.text,1,a.count,this._source);return b}},{key:"_match",value:function(a){if(this._parsed_input.original_text.length>a.length)return!1;var b=new h(a,(!0));return this._parsed_input.compare(b)}}]),a}();b.exports=k},{"../../../../lib/rh":24,"./consts":36,"./input_parser":42,"./prediction":45,"./prediction_list":47}],40:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=a("./utils"),h=function(){function a(){d(this,a)}return e(a,[{key:"initHistory",value:function(a){void 0===this._list&&(this._list=a||[])}},{key:"getHistory",value:function(){return this._list||[]}},{key:"_updateText",value:function(a,b){this.getHistory().splice(b,1),this.getHistory().unshift(a)}},{key:"_addNewText",value:function(a){this.getHistory().push(a)}},{key:"add",value:function(a){var b=f.findIndex(this.getHistory(),function(b){return 0===g.compareNoCase(a.text,b.text)});b>=0?this._updateText(a,b):this._addNewText(a)}},{key:"delete",value:function(a){var b=f.findIndex(this.getHistory(),function(b){return 0===g.compareNoCase(a,b.text)});b>=0&&this.getHistory().splice(b)}}]),a}();b.exports=new h},{"../../../../lib/rh":24,"./utils":52}],41:[function(a,b,c){"use strict";var d={MAP:{WORD:0,HASH:1,COUNT:2,MODEL_FILE_NO:3,MODEL_INDEX:4,TOPICS:5},MODEL:{WORD_HASH:0,COUNT:1,NEXT_MODEL:2},FIRST_PREDICTION:{NEXT:0,PREVIOUS:1}};b.exports=d},{}],42:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./utils"),rh=a("../../../../../src/lib/rh"),g=rh._,h=function(){function a(b,c,e,f){d(this,a),this.isPrevious=f,this.selection=void 0===e?b.length:e;var g=this._calculateSeparator(b);this.isPrevious||(this.isWholeWord=c||this._isWholeWord(b,g)),this.initText(b,g)}return e(a,[{key:"initText",value:function(a,b){this._computeText(a,b),this.trimmedText=this.original_text.trim(),this.words=g.compact(this.trimmedText.split(" ")||[]),this._reverseIfPrevious(),!this.isWholeWord&&this.words.length>0&&(this._partial=this.words.splice(-1)[0])}},{key:"_computeText",value:function(a,b){this._right_text="",this._left_text="",void 0===b&&(b=a.length),this.isSplitText=!(0===b||b===a.length);var c=a.substring(0,b),d=a.substring(b);this.isPrevious?(this.original_text=d,this._left_text=c.trim()):(this.original_text=c,this._right_text=d.trim())}},{key:"equalRemaingWord",value:function(a){if(""!==this._left_text||""!==this._right_text){var b=this._getRemainigWord();if(b)return 0===f.compareNoCase(b,a)}return!1}},{key:"_getRemainigWord",value:function(){var a=this.isPrevious?this._left_text.split(" "):this._right_text.split(" ");if(a=a||[],a=g.compact(a),a.length>0)return this.isPrevious?a[a.length-1]:a[0]}},{key:"completeSuggestion",value:function(a){return this.isPrevious?0===this._left_text.length?a:this._left_text+" "+a:0===this._right_text.length?a:a+" "+this._right_text}},{key:"_calculateSeparator",value:function(a){if(this.isPrevious){if(0===this.selection)return this.isWholeWord=!0,0;if(a.length>this.selection&&" "!==a[this.selection-1]){var b=a.lastIndexOf(" ",this.selection-1);return this.isWholeWord=!1,b>=0?b+1:0}this.isWholeWord=!0}return this.selection}},{key:"_reverseIfPrevious",value:function(){this.isPrevious&&this.words.reverse()}},{key:"_isWholeWord",value:function(a,b){return this.isPrevious?0===b||a.length>b&&" "===a[b-1]:b>0&&" "===a[b-1]}},{key:"compare",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(c=void 0===c?this.words.length-1:c,this.words.length>a.words.length)return!1;for(var d=b;d<=c;d++){var e=this.words[d],g=a.words[d];if(0!==f.compareNoCase(e,g))return!1}return this.matchPartial(a,d)}},{key:"matchPartial",value:function(a,b){if(void 0===this._partial)return!0;if(a.words.length<=b)return!1;var c=a.words[b];return this.comparePartial(c)}},{key:"comparePartial",value:function(a){return this._matchExp=new RegExp("^"+this._partial,"i"),this._matchExp.test(a)}},{key:"completeWord",value:function(a){return this.isWholeWord||void 0===this._partial||0===this._partial.length?this.getTermForCompleteWord(a,this.trimmedText):this.getTermForPartialText(a)}},{key:"getTermForPartialText",value:function(a){var b=a.substring(this._partial.length,a.length);if(this.isPrevious){var c="",d=this.trimmedText.indexOf(" ");return d>=0&&(c=this.trimmedText.substring(d)),this._partial+b+c}return this.trimmedText+b}},{key:"getTermForCompleteWord",value:function(a){return this.isPrevious?a+" "+this.trimmedText:this.trimmedText+" "+a}},{key:"replaceLastWord",value:function(a){var b=this.trimmedText;if(void 0!==this._partial&&!this.isWholeWord){var c=this.trimmedText.length-this._partial.length;b=this.trimmedText.substring(0,c),b=b.trim()}return b+" "+a}},{key:"equalLastWord",value:function(a){if(0===this.words.length)return!1;var b=this.words[this.words.length-1];return 0===f.compareNoCase(b,a)}}]),a}();b.exports=h},{"../../../../../src/lib/rh":24,"./utils":52}],43:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=rh.model,h=a("./utils"),i=a("./indices"),j=a("./consts"),k=a("../common/paths"),l=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";d(this,a),this._paths=new k(b)}return e(a,[{key:"init",value:function(a){this.loadIndex(a),this.loadMap(a)}},{key:"_isIndexLoaded",value:function(){return void 0!==this.index_data}},{key:"getModelCount",value:function(){return this.index_data.Model.length}},{key:"getMapHash",value:function(a){return this._hash_to_word[a]}},{key:"getHashes",value:function(a){if(void 0!==a&&a.length>0)return this.getAplhabetHashes(a[0])}},{key:"getAplhabetHashes",value:function(a){if(this.map_data&&1===a.length){var b=a.toLowerCase();return this.map_data[b]}}},{key:"getWordModel",value:function(a,b){var c=void 0,d=this._getHashForWord(a);return d&&b&&(c=b[d[i.MAP.MODEL_INDEX]]),c}},{key:"getCount",value:function(a){var b=this._getHashForWord(a);if(b)return b[i.MAP.COUNT]}},{key:"getModelData",value:function(a){var b=a[i.MAP.MODEL_FILE_NO],c=a[i.MAP.MODEL_INDEX],d=g.get(this._paths.getModelKey(b));return d||this.loadModel(b),d&&d[c]}},{key:"_compareWordCount",value:function(a,b){var c=h.getSafeElement(a,i.MAP.COUNT),d=h.getSafeElement(b,i.MAP.COUNT);return c&&d?d-c:0}},{key:"_buildTopWords",value:function(a){a.sort(this._compareWordCount),a.splice(100*j.max_predictions),this._top_words=a}},{key:"getModelFileNo",value:function(a){var b=this._getHashForWord(a);if(b)return b[i.MAP.MODEL_FILE_NO]}},{key:"_getHashForWord",value:function(a){var b=void 0,c=this.getHashKey(a);return c&&(b=this._hash_to_word[c]),b}},{key:"getHashKey",value:function(a){if(a&&a.length>0){var b=a.toLowerCase();return this._word_hash[b]}}},{key:"loadIndex",value:function(a){var b=this;this._isIndexLoaded()===!1?f.loadScript(this._paths.getIndexFilePath(),!0,function(){b.index_data=f.exports(),b.onIndexLoaded(a)},!0):this.onIndexLoaded(a)}},{key:"loadModel",value:function(a,b){var c=[];if(void 0!==a){var d=this._paths.getModelKey(a),e=g.get(d);if(void 0===e){g.publish(d,null);var h=this._paths.getModelFilePath(a);f.loadScript(h,!0,this.getOnModelLoadFn(a,b),!0)}else null===e&&void 0!==b?g.subscribe(d,b):this.doCallback(b,e,a)}else this.doCallback(b,c,a)}},{key:"doCallback",value:function(a,b,c){a&&a(b,c)}},{key:"getOnModelLoadFn",value:function(a,b){var c=this;return function(){var d=f.exports();g.publish(c._paths.getModelKey(a),d),b&&b(d,a)}}},{key:"onMapLoaded",value:function(a){this.parseMap(),this.index_data&&a&&a(this)}},{key:"onIndexLoaded",value:function(a){this.map_data&&a&&a(this)}},{key:"parseMap",value:function(){var a=this.map_data;this._word_hash={},this._hash_to_word={};var b=[];for(var c in a){var d=a[c];this._parseWordsData(d),b=b.concat(d)}this._buildTopWords(b)}},{key:"_parseWordsData",value:function(a){var b=this;f.each(a,function(a){var c=parseInt(a[i.MAP.HASH]);if(a[i.MAP.WORD]){var d=a[i.MAP.WORD].toString();b._word_hash[d]=c}b._hash_to_word[c]=a})}},{key:"isStopWord",value:function(a){var b=f.find(this.index_data.stopWords,function(b){return 0===h.compareNoCase(a,b)});return void 0!==b}},{key:"getTotalCount",value:function(){return this.index_data.totalCount}},{key:"wordHashfromIndexKey",value:function(a,b){return f.find(this._hash_to_word,function(c){return c[i.MAP.MODEL_INDEX]===a&&c[i.MAP.MODEL_FILE_NO]===b})}},{key:"loadMap",value:function(a){var b=this;void 0===this.map_data?f.loadScript(this._paths.getMapFilePath(),!0,function(){b.map_data=f.exports(),b.onMapLoaded(a)},!0):this.onMapLoaded(a)}},{key:"top_words",get:function(){return this._top_words}},{key:"nGram",get:function(){return this.index_data.nGram}},{key:"search_model",get:function(){return this.index_data.Model}},{key:"search_map",get:function(){return this.index_data.Map}},{key:"total_count",get:function(){return this.index_data.totalCount}},{key:"stop_words",get:function(){return this.index_data.stopWords}}]),a}();b.exports=l},{"../../../../lib/rh":24,"../common/paths":34,"./consts":36,"./indices":41,"./utils":52}],44:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=a("./prediction_creator"),h=a("./prediction_list"),i=a("./consts"),j=a("./indices"),k=function(){function a(b){var c=b.loader,e=b.level,f=b.callback,g=b.previous,h=b.max_predictions,j=void 0===h?20:h;d(this,a),this.level=e,this.previous=g,this._max_predictions=j,this.predictions=[],this._callback=f,this._loader=c,this._source=i.PREDICTOR_SOURCE_ID.NGRAM_PREDICTOR}return e(a,[{key:"init",value:function(){}},{key:"clear",value:function(){this._word_model=void 0,this._prediction_array=void 0,this.parsed_input=void 0,this.predictions=[]}},{key:"getPredictions",value:function(a){this.parsed_input=a,this.predictions=[],void 0!==a&&a.words.length>=this.level?(this.word_index=a.words.length-this.level,this._word=a.words[this.word_index],this._loadInputModel(this._word,this._compute_word_predictions.bind(this))):this._onResultsComputed()}},{key:"_compute_word_predictions",value:function(a){this.predictions=[];var b=this.level,c=this._word,d=this._loader.getCount(c);this._word_model=this._loader.getWordModel(c,a),this._word_model&&(this._prediction_array=this._get_prediction_array(),this._compute_prediction_from_model(c,b,d)),this._onResultsComputed()}},{key:"_onResultsComputed",value:function(){this._callback&&this._callback(new h(this.predictions,this.parsed_input),this._loader)}},{key:"_compute_prediction_from_model",value:function(a,b,c){if(void 0!==this._prediction_array)if(this._is_my_level(b))this._compute_next_words(c);else{b--;var d=this._get_word_index(b),e=this.parsed_input.words[d],f=this._loader.getHashKey(e),g=this._get_next_model(this._prediction_array,f);g&&(c=g[j.MODEL.COUNT],this._prediction_array=g[j.MODEL.NEXT_MODEL],this._compute_prediction_from_model(e,b,c))}}},{key:"_get_next_model",value:function(a,b){if(b){var c=f.find(a,function(a){return a.length>1&&a[j.MODEL.WORD_HASH]===b});return c&&c.length>j.MODEL.NEXT_MODEL&&Array.isArray(c)?c:void 0;
}}},{key:"_get_word_index",value:function(a){return this.parsed_input.words.length-a}},{key:"_is_my_level",value:function(a){return 1===a}},{key:"_continueFn",value:function(){return!0}},{key:"_compute_next_words",value:function(a){var b=this._prediction_array;if(b&&b.length>0)for(var c=0;this.predictions.length<this.max_predictions&&c<b.length&&b[c].length>1;c++)if(this._matches_partially(b[c])){var d=this._create_predictions(b[c],a);this._compute_next_multi_words(d)}}},{key:"_compute_next_multi_words",value:function(a){var b=this;f.each(a,function(a){void 0!==a&&b.predictions.push(a)})}},{key:"_get_word_hash",value:function(a){return this._loader.getMapHash(a[j.MODEL.WORD_HASH])}},{key:"_matches_partially",value:function(a){if(this.parsed_input.isWholeWord)return!0;var b=this._loader.getMapHash(a[j.MODEL.WORD_HASH]);if(!b)return!1;var c=b[j.MAP.WORD];return this.parsed_input.comparePartial(c)}},{key:"_create_predictions",value:function(a,b){var c=new g({loader:this._loader,model_item:a,total_count:b,parsed_input:this.parsed_input,continueFn:this._continueFn});return c.getMultiPredictions(void 0,void 0,void 0,this._source)}},{key:"_get_prediction_array",value:function(){return this.parsed_input.isPrevious&&this._word_model.length>1?this._word_model[1]:this._word_model[0]}},{key:"_loadInputModel",value:function(a,b){var c=this._findFileIndex(a);this._loader.loadModel(c,b)}},{key:"_findFileIndex",value:function(a){return this._loader.getModelFileNo(a)}},{key:"max_predictions",set:function(a){this.max_predictions=a},get:function(){return this._max_predictions}}]),a}();b.exports=k},{"../../../../lib/rh":24,"./consts":36,"./indices":41,"./prediction_creator":46,"./prediction_list":47}],45:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./utils"),h=d(g),i=function(){function a(b,c,d,f){e(this,a),this.probability=c,this.term=b,this.count=d,this.source=f}return f(a,[{key:"merge",value:function(a){this.probability+=a.probability,this.count=Math.max(this.count,a.count)}},{key:"compare",value:function(a){return a.probability-this.probability}},{key:"match",value:function(a){return 0===h["default"].compareNoCase(a.term,this.term)}}]),a}();b.exports=i},{"./utils":52}],46:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./prediction"),g=a("./utils"),h=a("./indices"),i=a("./input_parser"),j=a("./consts"),k=function(){function a(b){var c=b.loader,e=b.model_item,f=b.total_count,g=b.parsed_input,h=b.continueFn;d(this,a),this._model_item=e,this.parsed_input=g||new i(""),this._init(),this._total_count=f,this._continueFn=h||this._isStopWord,this._nextModelFn=this._nextModel,this._predictions=[],this._multi_prediction=!1,this._loader=c}return e(a,[{key:"_init",value:function(){this.term="",this.probability=1,this._first_word=!0,this.isFirstLevel=!1,this._level=0}},{key:"getPrediction",value:function(a,b,c,d){return this.word_hash=a,this.isFirstLevel=b,this.previous=c,this.source=d,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,a),this._createPrediction()}},{key:"getMultiPredictions",value:function(a,b,c,d){return this._multi_prediction=!0,this.word_hash=a,this.isFirstLevel=b,this.previous=c,this.source=d,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,a),this._predictions}},{key:"equalRemaingWord",value:function(a){var b=this._getword(a,this.word_hash);return!(!b||!this.parsed_input.equalRemaingWord(b))}},{key:"_appendPreviousPredictions",value:function(a){var b=this._getPreviousItem(a);if(b){var c=this._getPreviousProbability(b);c>j.minPreviousThreshold&&this._appendPreviousTerm(b)}}},{key:"_getPreviousItem",value:function(a){var b=g.getFirstLevelNextModel(a,!0);if(b){var c=g.getSafeElement(b,0);return c}}},{key:"_appendPreviousTerm",value:function(a){var b=this._getword(a);if(b){if(this.parsed_input.equalLastWord(b))return;this.term=this.parsed_input.replaceLastWord(b),this._first_word=!1}}},{key:"_createPrediction",value:function(){if(""!==this.term){var a=this.parsed_input.completeSuggestion(this.term);return new f(a,this.probability,1,this.source)}}},{key:"_appendPrediction",value:function(a){if(this.probability=this.probability*this._calculateProbability(a),this._update_term(a),this._shouldCreatePrediction(a)&&this._predictions.push(this._createPrediction()),this._continueFn(a)){var b=this._nextModel(a);this._total_count=this._getCount(a),this._level++,this._first_word=!1,this.isFirstLevel=!1,this.word_hash=void 0,b&&this._appendPrediction(b)}}},{key:"_getPreviousProbability",value:function(a){var b=this._getCount(this.model_item),c=g.getCountfromModel(a);return c/b}},{key:"_update_term",value:function(a){this.parsed_input.isPrevious?this.term=this._nextTerm(a)+this.term:this.term=this.term+this._nextTerm(a)}},{key:"_getword",value:function(a,b){return b=b||this._get_word_hash(a),g.getSafeElement(b,h.MAP.WORD)}},{key:"_get_word_hash",value:function(a){return this._loader.getMapHash(a[h.MODEL.WORD_HASH])}},{key:"_nextModel",value:function(a){var b=void 0;if(b=this.isFirstLevel?g.getFirstLevelNextModel(a,this.previous):g.getNextModel(a),b&&b.length>0)return g.getFirstPrediction(b)}},{key:"_nextTerm",value:function(a){var b=this._getword(a,this.word_hash);return b?this._first_word?this.parsed_input.completeWord(b):" "+b:""}},{key:"_calculateProbability",value:function(a){var b=this._getCount(a);return b/this._total_count}},{key:"_getCount",value:function(a){return this.word_hash?g.getCountfromWordHash(this.word_hash):g.getCountfromModel(a)}},{key:"_shouldCreatePrediction",value:function(a){return this._multi_prediction&&!this._isStopWord(a)&&!this.equalRemaingWord(a)}},{key:"_isStopWord",value:function(a){var b=this._getword(a,this.word_hash);return!!b&&this._loader.isStopWord(b)}}]),a}();b.exports=k},{"./consts":36,"./indices":41,"./input_parser":42,"./prediction":45,"./utils":52}],47:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this.parsed_input=c,this._list=b||[]}return e(a,[{key:"isForInput",value:function(a,b){return this.parsed_input.isPrevious?void 0!==b&&this.parsed_input.original_text===b.original_text:this.parsed_input.original_text===a.original_text}},{key:"isEmpty",value:function(){return 0===this._list.length}},{key:"predictions",get:function(){return this._list}}]),a}();b.exports=f},{}],48:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./loader"),rh=a("../../../../lib/rh"),g=rh._,h=a("./history_predictor"),i=a("./ngram_predictor"),j=a("./general_predictor"),k=a("./corrector"),l=a("./consts"),m=function(){function a(b,c){d(this,a),this._history_reader=b,this._processResultFn=c}return e(a,[{key:"_createLoaders",value:function(){return g.map(this.projectPaths,function(a){return new f(a)})}},{key:"createPredictors",value:function(a,b,c){var d=this;this._addFn=a,this._prevaddFn=b,this._addCorrectorFn=c;var e=new h(this._history_reader,this._processResultFn);this._addFn(e);var f=this._createLoaders();g.each(f,function(a){a.init(d.addPredictors.bind(d))})}},{key:"addPredictors",value:function(a){for(var b=1;b<=a.nGram;b++){var c=new i({loader:a,level:b,callback:this._processResultFn});c.init(),this._addFn(c)}for(var d=1;d<=l.previousnGram;d++){var e=new i({loader:a,level:d,callback:this._processResultFn,previous:!0});e.init(),this._prevaddFn(e)}var f=new j(this._processResultFn,a);this._addFn(f);var g=new k(a,this._processResultFn);this._addCorrectorFn(g)}},{key:"projectPaths",get:function(){return rh.model.get(rh.consts("KEY_PROJECT_LIST"))}}]),a}();b.exports=m},{"../../../../lib/rh":24,"./consts":36,"./corrector":37,"./general_predictor":38,"./history_predictor":39,"./loader":43,"./ngram_predictor":44}],49:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=rh.consts,h=a("./history_reader"),i=a("./input_parser"),j=a("../common/merger"),k=a("./topic_counter"),l=a("./utils"),m=a("./consts"),n=a("./../../../common/counting_seamaphore"),o=a("./predictors_creator"),p=a("../topic/handler"),q=5,r=function(){function a(b){var c=this;d(this,a),this.widget=b,this._predictors=[],this._correctors=[],this._previous_predictors=[],this.initHandleKeyHash(),this.max_predictions=q,this.predicton_merger=new j([]),b.model.subscribe(g("KEY_PROJECT_LIST"),function(){c.init()}),this.search_handler=new p(b)}return e(a,[{key:"init",value:function(){var a=rh.storage.fetch(g("PREV_SEARCH_KEY"));h.initHistory(a),this.create_predictors(),this.widget.model.csubscribe("EVT_CLOSE_SEARCH_SUGGESTION",this.closeSuggestions.bind(this)),this.widget.model.csubscribe("EVT_SEARCH_TERM",this.search.bind(this))}},{key:"search",value:function(){var a=this.widget.get(g("KEY_SEARCH_TERM"));this.search_handler.showSearchResults(a)}},{key:"create_predictors",value:function(){this._predictors=[];var a=new o(h,this.processResult.bind(this));a.createPredictors(this.addPredictor.bind(this),this.addPrevPredictor.bind(this),this.addCorrector.bind(this))}},{key:"addPredictor",value:function(a){this._predictors.push(a)}},{key:"addPrevPredictor",value:function(a){this._previous_predictors.push(a)}},{key:"addCorrector",value:function(a){this._correctors.push(a)}},{key:"showSuggestions",value:function(a){this._initSuggestions(a),this._calculateSugguestions()}},{key:"_initSuggestions",value:function(a){this._initResult(),this._initInputs(a),this._resutSeamaphore=new n(this.onResultComplete.bind(this))}},{key:"_initInputs",value:function(a){this.parsed_input=new i(a.text,(!1),a.selStart,(!1)),l.isPrevious(a)&&(this._previous_input=new i(a.text,(!1),a.selStart,(!0)))}},{key:"_calculateSugguestions",value:function(){var a=this;this._resutSeamaphore.wait(this._predictorCount()),f.each(this._predictors,function(b){b.getPredictions(a.parsed_input)}),this._previous_input&&f.each(this._previous_predictors,function(b){b.getPredictions(a._previous_input)})}},{key:"_clearPredictors",value:function(){f.each(this._predictors,function(a){a.clear()}),f.each(this._previous_predictors,function(a){a.clear()}),f.each(this._correctors,function(a){a.clear()})}},{key:"_predictorCount",value:function(){var a=this._predictors.length;return this._previous_input&&(a+=this._previous_predictors.length),a}},{key:"_initResult",value:function(){this.predicton_merger&&this.predicton_merger.clear(),this.widget.publish("selected",void 0),this._previous_input=void 0,this._computing_correction=!1}},{key:"_clearResult",value:function(){this._resetMovement(),this._previous_input=void 0,this.parsed_input=void 0,this._resutSeamaphore=void 0,this._clearPredictors()}},{key:"isSuggestionsOpen",value:function(){var a=this.widget.get(g("SEARCH_RESULTS_KEY"));return a&&a.length>0}},{key:"processResult",value:function(a,b){if(a.isForInput(this.parsed_input,this._previous_input)){if(!a.isEmpty()){this.predicton_merger.merge(a.predictions);var c=new k(b);this.predictions=c.computeCounts(this.predictions,this.parsed_input)}this._resutSeamaphore.signal()}}},{key:"onResultComplete",value:function(){this.needCorrection()?this.doCorrection():(this.predictions.splice(this.max_predictions),this.widget.publish(g("SEARCH_RESULTS_KEY"),this.predictions),this._clearResult())}},{key:"needCorrection",value:function(){return!this._computing_correction&&0===this.predictions.length&&""!==this.parsed_input.trimmedText}},{key:"doCorrection",value:function(){var a=this;this._computing_correction=!0,this._resutSeamaphore=new n(this.onResultComplete.bind(this)),this._resutSeamaphore.wait(this._correctors.length),f.each(this._correctors,function(b){b.getCorrections(a.parsed_input)})}},{key:"canDelete",value:function(a){var b=this.predictions[a];return void 0!==b&&b.source===m.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR}},{key:"handleDelete",value:function(a){var b=this.predictions[a];this._deleteFromHistory(b.term),this._removePrediction(a),this.widget.publish("history_deleted",!0)}},{key:"_removePrediction",value:function(a){this.predictions.splice(a,1),this.widget.publish(g("SEARCH_RESULTS_KEY"),this.predictions)}},{key:"handleClick",value:function(a){var b=this.widget.get("history_deleted");if(!b){var c=this.predictions[a];if(void 0!==c){var d=c.term;this._addToHistory(d),this.widget.publish(g("KEY_SEARCH_TERM"),d),this.widget.publish(rh.consts("EVT_SEARCH_TERM"),!0)}}}},{key:"handleFocusOut",value:function(a,b){var c=this.widget.get("history_deleted");c?(this.widget.publish("history_deleted",!1),this.widget.publish(b,!0)):this.widget.publish(a,!1)}},{key:"getFirstSuggestionIndex",value:function(a,b){return b?0:a-1}},{key:"getNextSuggestionIndex",value:function(a,b,c){var d=c?1:b-1;return a=void 0===a?0:a,a=(a+d)%b}},{key:"handleArrowKey",value:function(a){var b=this.widget.get("selected"),c=40===a.keyCode,d=this.getPredictionsLength();if(d>0){b=void 0===b?this.getFirstSuggestionIndex(d,c):this.getNextSuggestionIndex(b,d,c),this.widget.publish("selected",b);var e=this.getNewInputText(this.results[b]);this.widget.publish(g("KEY_SEARCH_TERM"),e)}}},{key:"getNewInputText",value:function(a){return a.term}},{key:"getPredictionsLength",value:function(){var a=void 0;return this.results=this.widget.get(g("SEARCH_RESULTS_KEY")),this.results&&(a=this.results.length),a}},{key:"closeSuggestions",value:function(){this._clearResult(),this.widget.publish("selected",void 0),this.original_parsed_input=void 0,this.widget.publish(g("SEARCH_RESULTS_KEY"),[])}},{key:"_deleteFromHistory",value:function(a){h["delete"](a),this._saveHistory()}},{key:"_addToHistory",value:function(a){a&&""!==a&&(h.add({text:a.trim(),count:10}),this._saveHistory())}},{key:"_saveHistory",value:function(){rh.storage.persist(g("PREV_SEARCH_KEY"),h.getHistory())}},{key:"handleShowSuggestion",value:function(a){""===a.text||l.shouldShowSuggestion(a)===!1?this.closeSuggestions():this.showSuggestions(a)}},{key:"handleReturn",value:function(a){""!==a.text&&(this._addToHistory(a.text),this.closeSuggestions(),this.widget.publish(g("KEY_SEARCH_TERM"),a.text),this.widget.publish(g("EVT_SEARCH_TERM"),!0))}},{key:"_isMovementKey",value:function(a){return[38,39,40].indexOf(a)>=0}},{key:"_resetMovement",value:function(){this.original_parsed_input=void 0,this.widget.publish("selected",void 0)}},{key:"_isHandlingCursorMove",value:function(){var a=this.widget.get("selected");return void 0!==a}},{key:"initHandleKeyHash",value:function(){this.handle_key_hash={up:this.handleArrowKey.bind(this),down:this.handleArrowKey.bind(this),backspace:this.handleBackSpace.bind(this),"return":this.handleReturn.bind(this),"default":this.handleShowSuggestion.bind(this),escape:this.handleEscape.bind(this),right:this.handleRight.bind(this)}}},{key:"handleRight",value:function(a){return this._isHandlingCursorMove()?(l.shouldAppendSpace(a)&&(a.text+=" ",a.selStart+=1,this.widget.publish(g("KEY_SEARCH_TERM"),a.text)),this._resetMovement(),this.handleShowSuggestion(a),!1):(this._resetMovement(),this.handleShowSuggestion(a))}},{key:"handleBackSpace",value:function(a){return this.handleShowSuggestion(a)}},{key:"handleEscape",value:function(){this.closeSuggestions()}},{key:"handleKey",value:function(a){var b=a.keyCode,c={keyCode:b,selStart:a.target.selectionStart,text:a.target.value};this._isMovementKey(b)||this._resetMovement();var d=f.getKeyIndex(b);if(void 0===d)return!0;var e=this.handle_key_hash[d];return e?e(c):void 0}},{key:"predictions",get:function(){return this.predicton_merger.items},set:function(a){this.predicton_merger=new j(a)}}]),a}();rh.controller("SearchController",r)},{"../../../../lib/rh":24,"../common/merger":33,"../topic/handler":53,"./../../../common/counting_seamaphore":25,"./consts":36,"./history_reader":40,"./input_parser":42,"./predictors_creator":48,"./topic_counter":51,"./utils":52}],50:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this._set=b||[],this._initialised=!1}return e(a,[{key:"intersect",value:function(a){Array.isArray(a)||(a=a.set);for(var b=[],c=0,d=0,e=0;d<this._set.length&&e<a.length;)this._set[d]<a[e]?d++:this._set[d]>a[e]?e++:(b[c++]=this._set[d],d++,e++);this._set=b}},{key:"intersectOrSet",value:function(a){this._initialised?this.intersect(a):(Array.isArray(a)||(a=a.set),this.set=a,this._initialised=!0)}},{key:"intersectCount",value:function(a){Array.isArray(a)||(a=a.set);for(var b=0,c=0,d=0;c<this._set.length&&d<a.length;)this._set[c]<a[d]?c++:this._set[c]>a[d]?d++:(b++,c++,d++);return b}},{key:"set",set:function(a){this._set=a||[]},get:function(){return this._set}},{key:"length",get:function(){return this._set.length}}]),a}();b.exports=f},{}],51:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./sorted_set"),g=a("./input_parser"),h=a("./prediction"),rh=a("../../../../lib/rh"),i=rh._,j=a("./indices"),k=function(){function a(b){d(this,a),this.newPredictions=[],this.predictionSet=new f,this.inputSet=new f,this._loader=b}return e(a,[{key:"computeCounts",value:function(a,b){var c=this;return this.newPrediction=[],this.parsed_input=b,i.each(a,function(a){c.addUpdatedPrediction(a)}),this.newPredictions}},{key:"addUpdatedPrediction",value:function(a){var b=1;if(void 0!==this._loader&&(this.createPredictionSet(a),b=this.computeTopicCount()),b>0){var c=new h(a.term,a.probability,b,a.source);this.newPredictions.push(c)}}},{key:"computeTopicCount",value:function(){return this.predictionSet.set.length}},{key:"createPredictionSet",value:function(a){var b=this;this.predictionSet=new f;var c=new g(a.term,(!0));i.each(c.words,function(a,c){b._addWordToSet(a,b.predictionSet,c)})}},{key:"initInput",value:function(a){var b=this;this.inputSet=new f,i.each(a.words,function(a){b._addWordToSet(a,b.inputSet)})}},{key:"_addWordToSet",value:function(a,b){if(!this._loader.isStopWord(a)){var c=this._loader._getHashForWord(a);c&&c.length>j.MAP.TOPICS&&b.intersectOrSet(c[j.MAP.TOPICS])}}}]),a}();b.exports=k},{"../../../../lib/rh":24,"./indices":41,"./input_parser":42,"./prediction":45,"./sorted_set":50}],52:[function(a,b,c){(function(c){"use strict";var d=a("./indices"),e={getNextModel:function(a){if(a&&Array.isArray(a)&&a.length>d.MODEL.NEXT_MODEL)return a[d.MODEL.NEXT_MODEL]},getFirstLevelNextModel:function(a,b){if(a&&Array.isArray(a)){if(!b&&a.length>d.FIRST_PREDICTION.NEXT)return a[d.FIRST_PREDICTION.NEXT];if(b&&a.length>d.FIRST_PREDICTION.PREVIOUS)return a[d.FIRST_PREDICTION.PREVIOUS]}},getFirstPrediction:function(a){if(a&&Array.isArray(a)&&a.length>0&&Array.isArray(a[0]))return a[0]},compareNoCase:function(a,b){return void 0!==c.compare?c.compare(a,b):a===b?0:-1},hammingDistance:function f(a,b){for(var c=Math.min(a.length,b.length),f=0,d=0;d<c;d++)a[d]!==b[d]&&f++;return a.length>c&&(f+=a.length-c),f},isPrevious:function(a){return a.selStart<a.text.length},shouldShowSuggestion:function(a){var b=a.text,c=a.selStart;return 0===c||c===b.length||b.length>0&&(" "===b[c]||" "===b[c-1])},shouldAppendSpace:function(a){var b=a.text,c=a.selStart;return b.length>0&&c===b.length&&" "!==b[b.length-1]},getSafeElement:function(a,b){if(a&&Array.isArray(a)&&a.length>b)return a[b]},getCountfromModel:function(a){return Array.isArray(a)&&a.length>d.MODEL.COUNT?a[d.MODEL.COUNT]:0},getCountfromWordHash:function(a){return Array.isArray(a)&&a.length>d.MAP.COUNT?a[d.MAP.COUNT]:0}};b.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./indices":41}],53:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./query/processor"),rh=a("../../../../lib/rh"),g=rh._,h=rh.consts,i=a("./query/loader"),j=a("../common/merger"),k=a("../../../common/counting_seamaphore"),l=a("./result");b.exports=function(){function a(b){var c=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;d(this,a),this.widget=b,this.initDone=!1,this.max_results=e,this.queryProcessors=[],this.merger=new j([]),this._resutSeamaphore=new k(this.onResultComplete.bind(this)),this.widget.model.subscribe(h("KEY_PROJECT_LIST"),function(){c.init()})}return e(a,[{key:"init",value:function(){var a=this;if(!this.initDone){var b=this._createLoaders();g.each(b,function(b,c){b.init(c,a.addProcessors.bind(a))}),this.initDone=!0}}},{key:"addProcessors",value:function(a){this.queryProcessors.push(new f(a))}},{key:"_createLoaders",value:function(){return g.map(this.projectPaths,function(a){return new i(a)})}},{key:"showSearchResults",value:function(a){var b=this,c=g.find(this.queryProcessors,function(c){return c.isNewQuery(a,b.searchOpts)});c&&(this.merger=new j([]),this._resutSeamaphore=new k(this.onResultComplete.bind(this)),this._resutSeamaphore.wait(this.processorCount),g.each(this.queryProcessors,function(c){c.search(a,b.searchOpts,b.topicCallback.bind(b),b.onSearchResults.bind(b));var d=c.searchGlossary(a);b.processGlossaryResults(a,d)}))}},{key:"onSearchResults",value:function(a,b){this.processTopicsResults(a,b),this._resutSeamaphore.signal()}},{key:"onResultComplete",value:function(){this.widget.publish(rh.consts("EVT_SEARCH_IN_PROGRESS"),!1,{sync:!0});var a=g.mapToEncodedString(g.extend({rhsearch:this.text}));this.widget.publish(h("KEY_SEARCH_RESULT_PARAMS"),a),this.widget.publish(".p.searchresults",this.merger.items)}},{key:"topicCallback",value:function(a,b,c){this.widget.publish(".p.searchsummary"+a,b),this.widget.publish(".p.searchurl"+a,c)}},{key:"processGlossaryResults",value:function(a,b){var c=b&&Object.keys(b)[0];this.widget.publish(h("KEY_GLOSSARY_RESULT_TERM"),c),this.widget.publish(h("KEY_GLOSSARY_RESULT"),b[c])}},{key:"processTopicsResults",value:function(a,b){this.text=a;var c=g.map(b,function(a){return new l(a)});this.merger.merge(c)}},{key:"projectPaths",get:function(){return rh.model.get(rh.consts("KEY_PROJECT_LIST"))}},{key:"processorCount",get:function(){return this.queryProcessors.length}},{key:"searchOpts",get:function(){return{andSearch:"1"===rh.model.get(rh.consts("KEY_AND_SEARCH")),cbt:rh.model.cget("KEY_TAG_EXPRESSION"),origin:rh.model.cget("KEY_TOPIC_ORIGIN")}}}]),a}()},{"../../../../lib/rh":24,"../../../common/counting_seamaphore":25,"../common/merger":33,"./query/loader":57,"./query/processor":58,"./result":61}],54:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();b.exports=function(){function a(b){d(this,a),this.data=JSON.parse(b)}return e(a,[{key:"getTopicData",value:function(a){return this.topicData[a]}},{key:"getTopicSummary",value:function(a){return this.topicData[a]&&this.topicData[a].summary}},{key:"getTopicNextId",value:function(a){return this.topicData[a]&&this.topicData[a].next}},{key:"settings",get:function(){return this.data.settings}},{key:"topicData",get:function(){return this.data.metadata}},{key:"context",get:function(){return this.settings.context}},{key:"fields",get:function(){return this.settings.fields}}]),a}()},{}],55:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=rh._;b.exports=function(){function a(b,c,e){d(this,a),this.fileds=b,this.origin=c,this.tagExprs=e}return e(a,[{key:"filter",value:function(a){var b=this;return f.reduce(a,function(a,c){return a||b._isFilterd(c)},!1)}},{key:"_isFilterd",value:function(a){var b=this.getCbt(a);return b&&this._isFilteredCbt(b)}},{key:"_isFilteredCbt",value:function(a){var b=this,c=a.split(";");return!f.any(c,function(a){return f.evalTagExpression(a,b.tagExprs,b.origin)})}},{key:"getCbt",value:function(a){return a&&a.attributes&&a.attributes.length>0&&f.map(a.attributes,function(a){return a.value}).join(";")}}]),a}()},{"../../../../../lib/rh":24}],56:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("lunr"),g=a("../../common/synonymns"),rh=a("../../../../../lib/rh"),h=rh._;b.exports=function(){function a(b,c){d(this,a),this.init(b,c)}return e(a,[{key:"init",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.settings=b,this.processSyn(),this.registerFunctions(),this.setTokenizer(),this.db=f.Index.load(a)}},{key:"registerFunctions",value:function(){var a=this.replaceSynonymn.bind(this),b=this.addQuery.bind(this);f.Pipeline.registerFunction(a,"replaceSynonymn"),f.Pipeline.registerFunction(b,"addQuery")}},{key:"setTokenizer",value:function(){f.tokenizer.separator=/[\s\.\-\'\,\n;\:\\\/\"]+/}},{key:"processSyn",value:function(){var a=this.settings&&this.settings.synonyms||{},b=new g(a);this.settings.rootWords=b.rootWords}},{key:"addQuery",value:function(a){var b=a.toString();return this.queryWords.push(b),this.queryWords=h.unique(this.queryWords),a}},{key:"replaceSynonymn",value:function(a){var b=this,c=a.toString(),d=this.settings&&this.settings.rootWords&&this.settings.rootWords[c];return d&&d!==c?a.update(function(){return b.settings.rootWords[c]}):a}},{key:"addStopWords",value:function(a,b){if(b){var c=f.generateStopWordFilter(b);a.pipeline.before(f.stopWordFilter,c),a.pipeline.remove(f.stopWordFilter)}}},{key:"search",value:function(a){var b=this;this.queryWords=[];var c=a.getParams(this.isStopWord.bind(this)).trim(),d=rh._.isEmptyString(c)?[]:this.db.search(c);return a.opts?h.filter(d,function(c){return b.match(c,a.opts)}):d}},{key:"match",value:function(a,b){var c=this,d=!0;if(b.andSearch){var e=a&&a.matchData.metadata||[];h.each(this.queryWords,function(a){e[a]||c.isStopWord(a)||(d=!1)})}return d}},{key:"isStopWord",value:function(a){return this.settings.stopWords.indexOf(a.toLowerCase())!==-1}},{key:"searchGlossary",value:function(a){var b=this,c=this.settings&&this.settings.glossary||{},d=this.getRootTokens(a),e=h.reduce(c,function(a,c,e){var f=b.getRootTokens(e);return d.length===f.length&&b.matchTokens(d,f)&&(a[e]=c),a},{});return e}},{key:"matchTokens",value:function(a,b){var c=!0;return h.each(a,function(a,d){a!==b[d]&&(c=!1)}),c}},{key:"getRootTokens",value:function(a){var b=this,c=f.tokenizer(a);return h.map(c,function(a){var c=a.toString();return b.settings.rootWords[c]||c})}},{key:"export",value:function(){return this.db.toJSON()}}]),a}()},{"../../../../../lib/rh":24,"../../common/synonymns":35,lunr:23}],57:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=rh._,g=a("../../common/paths");b.exports=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";d(this,a),this._paths=new g(b)}return e(a,[{key:"init",value:function(a,b){this.id=a,b(this)}},{key:"loadDB",value:function(a){var b=this._paths.getSearchDbFilePath();f.loadScript(b,!0,function(){var b=f.exports();a&&a(b)},!0)}},{key:"getId",value:function(a){return this.id+"_"+a}},{key:"getUrl",value:function(a){return this._paths._getRelativePath(a)}},{key:"loadMetaData",value:function(a){var b=this._paths.getMetadataFilePath();f.loadScript(b,!0,function(){var b=f.exports();a&&a(b)},!0)}},{key:"loadTextData",value:function(a,b,c){var d=this._paths.getTextFilePath(b);f.loadScript(d,!0,function(){var d=f.exports();c&&c(a,b,d)},!0)}}]),a}()},{"../../../../../lib/rh":24,"../../common/paths":34}],58:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./db"),g=a("./query"),h=a("./summary"),rh=a("../../../../../lib/rh"),i=rh._,j=a("../../../../common/counting_seamaphore"),k=a("../text_merger"),l=a("../metadata"),m=a("./cbt");b.exports=function(){function a(b){var c=this;d(this,a),this.loader=b,this.metadataLoaded=this.dbLoaded=!1,this.loader.loadDB(function(a){c.initDB(a)}),this.loader.loadMetaData(function(a){c.initMetadata(a)})}return e(a,[{key:"initMetadata",value:function(a){this.metadataLoaded=!0,this.metadata=new l(a),!this.init&&this.dbContent&&(this.initDB(this.dbContent),this.dbContent=null)}},{key:"initDB",value:function(a){this.metadataLoaded?(this.db=new f(a,this.metadata.settings),this.init=!0,this.waiting&&(this.waiting=!1,this.getResults())):this.dbContent=a}},{key:"topicsLoaded",value:function(){this.exactSearch&&this.filter()}},{key:"isNewQuery",value:function(a,b){var c=this.buildQuery(a,b);return!this.query||!this.query.isEqual(c)}},{key:"search",
value:function(a,b,c,d){var e=this.buildQuery(a,b);this.isNewQuery(a,b)&&(this.text=a,this.seamaphore=new j(this.topicsLoaded.bind(this)),this.query=e,this.topicCallback=c,this.opts=b,this.summaries={},this.resultsCallback=d,this.exactSearch=this.query.exactMatch,this.getResults())}},{key:"filter",value:function(){var a=this,b=this.query.exaxctTerms;this.results=i.filter(this.results,function(c){var d=a.resultsMetadata[c.id].topicText;return a.matchesExact(b,d,c.id)}),this.resultsCallback(this.query.text,this.results),this.processSummary()}},{key:"processSummary",value:function(){var a=this;i.each(this.results,function(b){var c=b.id;a.topicCallback(a.loader.getId(c),a.summaries[c],a.createUrl(c,a.query.exaxctTerms))})}},{key:"matchesExact",value:function(a,b,c){var d=this,e=!1;return i.each(a,function(a){var f=b.toLowerCase().indexOf(a);f!==-1&&(d.addSummary(c,b,f,a),e=!0)}),e}},{key:"addSummary",value:function(a,b,c,d){var e=this.metadata.getTopicSummary(a);if(this.metadata.context&&e)this.summaries[a]=e;else{var f=new h(this.metadata.topicData,this.metadata.context);this.summaries[a]=f.getSummaryText(b,c,d.length,d)}}},{key:"getResults",value:function(){return this.init?(this.results=this.process(),this.needsCorrection&&this.doCorrection(),this.exactSearch||this.resultsCallback(this.query.text,this.results),void(this.exactSearch&&0===this.results.length&&this.resultsCallback(this.query.text,this.results))):void(this.waiting=!0)}},{key:"doCorrection",value:function(){this.query=this.buildQuery(this.query.text,i.extend(this.opts,{fuzzy:!0})),this.results=this.process()}},{key:"searchGlossary",value:function(a){var b=this.buildQuery(a);return this.processGlossary(b)}},{key:"buildQuery",value:function(a,b){return new g(a,this.metadata.settings,b,this.filterItem.bind(this))}},{key:"process",value:function(){var a=this;this.resultsMetadata={};var b=this.db.search(this.query);return this.seamaphore.wait(b.length),i.each(b,function(b){var c=a.metadata.getTopicData(b.ref);a.resultsMetadata[b.ref]=b.matchData.metadata,a.loader.loadTextData(a.query,b.ref,a.processTopicData.bind(a)),i.extend(b,c),b.id=b.ref,b.ref=a.loader.getId(b.ref)}),b}},{key:"processGlossary",value:function(a){return this.db.searchGlossary(a.text)}},{key:"processTopicData",value:function(a,b,c){if(this.query.isEqual(a)){var d=this.resultsMetadata[b];if(d){var e=[],f=new h(this.metadata.topicData,this.metadata.context),g=f.getSummary(b,d,e,c);g=g.replace(/\t+/gi," ").trim(),this.resultsMetadata[b].topicText=this.createText(b,c),this.exactSearch||this.topicCallback(this.getId(b),g,this.createUrl(b,e))}this.seamaphore.signal()}}},{key:"createText",value:function(a,b){var c=this.metadata.getTopicNextId(a),d=new k(c,b,this.filterId.bind(this));return d.getText()}},{key:"filterId",value:function(a){var b=this.metadata.fields,c=b[a];return this.filterItem(c)}},{key:"filterItem",value:function(a){var b=this.metadata.fields,c=new m(b,this.opts.origin,this.opts.cbt);return a&&c.filter(a)}},{key:"getId",value:function(a){return this.loader.getId(a)}},{key:"createUrl",value:function(a,b){var c=this.metadata.getTopicData(a),d=this.exactSearch?'"'+b[0]+'"':b;if(c){var e="?"+i.mapToEncodedString({rhsearch:this.query.originalText,rhhlterm:d});return""+this.loader.getUrl(c.relUrl)+e}}},{key:"needsCorrection",get:function(){return 0===this.results.length&&this.metadata.settings.fuzzy&&!this.query.exactMatch}}]),a}()},{"../../../../../lib/rh":24,"../../../../common/counting_seamaphore":25,"../metadata":54,"../text_merger":62,"./cbt":55,"./db":56,"./query":59,"./summary":60}],59:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=rh._,g=a("./cbt"),h=a("lunr");b.exports=function(){function a(b,c,e){d(this,a),this.originalText=b.trim(),this.text=this.originalText.toLowerCase(),this.settings=c||{},this.opts=e||{},this.checkExactMatch()}return e(a,[{key:"filter",value:function b(a){var b=new g(this.settings.fields,this.opts.origin,this.opts.cbt);return b.filter(a)}},{key:"getParams",value:function(a){return this.isStopWord=a,""+this.fieldsParam}},{key:"isEqual",value:function(a){return this.text===a.text&&this._bExactMatch===a._bExactMatch&&f.isEqual(this.opts,a.opts)}},{key:"getFuzzyText",value:function(a,b,c){return this.isStopWord(b)?"":this.opts.fuzzy?a+":"+b+"~1^"+c:a+":"+b+"^"+c}},{key:"checkExactMatch",value:function(){this._isExactMatch&&(this._bExactMatch=!0,this.text=this.text.substring(1,this.text.length-1))}},{key:"getFieldBoost",value:function(a){return f.reduce(a,function(a,b){return b&&b.boost&&b.boost>a?b.boost:a},1)}},{key:"_isExactMatch",get:function(){return this.text.length>2&&this.quotesChar.indexOf(this.text[0])!==-1&&this.quotesChar.indexOf(this.text[this.text.length-1])!==-1}},{key:"exactMatch",get:function(){return this._bExactMatch}},{key:"exaxctTerms",get:function(){return[this.text]}},{key:"quotesChar",get:function(){return['"',"'"]}},{key:"fieldsParam",get:function(){var a=this,b="";return f.each(this.settings.fields,function(c,d){if(!a.filter(c)){var e=f.map(h.tokenizer(a.text),function(a){return a.str}),g=a.getFieldBoost(c);f.each(e,function(c){b=b+" "+a.getFuzzyText(d,c,g)})}}),b}}]),a}()},{"../../../../../lib/rh":24,"./cbt":55,lunr:23}],60:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=a("../text_merger"),g=rh._;b.exports=function(){function a(b,c){d(this,a),this.topicData=b,this.context=c}return e(a,[{key:"minDistance",value:function(){}},{key:"getSummary",value:function(a,b,c,d){var e=this;if(this.context){var h=this.topicData[a]&&this.topicData[a].summary;if(h)return h}var i=g.map(b,function(a){return g.union(a,function(a,b){return g.union(a.position,function(a){var g=d[b],h=new f,i=h.getIndexText(g),j=i.substring(a[0],a[0]+a[1]);return j=j.toLowerCase(),c.indexOf(j)===-1&&c.push(j),e.getSummaryText(i,a[0],a[1],j)})})}),j="";return g.each(i[0]||[],function(a){a.length>j.length&&(j=a)}),j}},{key:"getSummaryText",value:function(a,b,c,d){var e=a.substring(0,b),f=a.substring(b+c);return this.trimLeft(e)+"<b>"+d+"</b>\n              "+this.trimRight(f)}},{key:"trimLeft",value:function(a){var b=a.indexOf(" ",a.length-30);return a=a.substring(b,a.length),a.trimStart()}},{key:"trimRight",value:function(a){var b=a.indexOf(" ",70);return b=b===-1?a.length:b,a=a.substring(0,b),a.trimEnd()}}]),a}()},{"../../../../../lib/rh":24,"../text_merger":62}],61:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("../suggestion/utils"),h=d(g);b.exports=function(){function a(b){e(this,a),this.fRanking=b.score,this.nIndex=1,this.strSummary=".p.searchsummary"+b.ref,this.strTitle=b.title,this.strUrl=".p.searchurl"+b.ref,this.strBreadcrumbs=b.relUrl}return f(a,[{key:"merge",value:function(a){this.fRanking+=a.fRanking}},{key:"compare",value:function(a){return a.fRanking-this.fRanking}},{key:"match",value:function(a){return 0===h["default"].compareNoCase(a.strUrl,this.strUrl)}}]),a}()},{"../suggestion/utils":52}],62:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._;b.exports=function(){function a(b,c,e){d(this,a),this.nextTexts=b,this.texts=c,this.separator=" ",this.filter=e||this.defaultFilter}return e(a,[{key:"join",value:function(a,b,c){for(var d=[],e=b;e<=c;e++)this.texts[a][e]&&d.push(this.texts[a][e]);return d.join(this.separator)}},{key:"defaultFilter",value:function(){return!1}},{key:"getIndexText",value:function(a){return a.join(this.separator).replace(/\n/gi,this.separator).trim()}},{key:"getText",value:function(){var a=this,b=[];return f.each(this.nextTexts,function(c){a.filter(c[0])||b.push(a.join(c[0],c[1],c[2]))}),b.join(this.separator)}}]),a}()},{"../../../../lib/rh":24}],63:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh._,g=rh.consts,h=function(){function a(b){d(this,a),this.widget=b}return e(a,[{key:"getLink",value:function(a){var b=a,c=this.widget.get(g("KEY_SEARCH_RESULT_PARAMS")),d=this.widget.get(g("KEY_SEARCH_TERM")),e="";if(d&&""!==d){var h=g("HASH_KEY_RH_SEARCH"),i={};i[h]=d,e=f.mapToEncodedString(i)}return void 0!==c&&""!==c?b=b+c+"&"+e:""!==e&&(b=b+"?"+e),b}}]),a}();rh.controller("SearchResultController",h)},{"../../lib/rh":24}],64:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh._,g=rh.consts,h=function(){function a(b){d(this,a),this.widget=b}return e(a,[{key:"select",value:function(a,b){this.widget.publish(g("KEY_TOC_SELECT_ITEM"),{id:a,url:b})}},{key:"getLink",value:function(a){if(a){var b=this.widget.get(g("KEY_TOC_BREADCRUMBS")),c=b[a];if(c&&c.hasUrl)return c.url}}},{key:"goToHome",value:function(a){if(a){var b=this.widget.get(g("KEY_TOC_BREADCRUMBS")),c=b[a];c&&!c.hasUrl&&f.goToHome({rhtocid:c.id})}}}]),a}();rh.controller("TocBreadcrumbsController",h)},{"../../lib/rh":24}],65:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../lib/rh"),f=rh.$,g="change",h=".carousel-item:not(.hide):not(.rh-hide)",i=function(){function a(b,c){var e=this;d(this,a),this.widget=b,this.node=this.widget.node,this.tab=0,rh.model.subscribeOnce(rh.consts(c.key),function(){e.widget.publish(g,!0)}),rh.model.subscribe(rh.consts("KEY_SCREEN"),function(){e["goto"](e.tab,0)}),rh.model.subscribe(c.key+"gototab",function(a){e["goto"](e.pagecount(),a.tab)})}return e(a,[{key:"goto",value:function(a,b){var c=this;this.tab=b,this.carouselnode=f.find(this.node,".carousel")[0],this.animateLeft(a),rh._.delay(function(){c.widget.publish(g,!0)},1e3)}},{key:"hasNext",value:function(){this.carouselnode=f.find(this.node,".carousel")[0];var a=f.find(f.find(this.node,".carousel")[0],h);return a=a&&a.length>0?a[a.length-1]:null,a.offsetLeft+this.carouselnode.offsetLeft>this.carouselnode.offsetWidth}},{key:"animateLeft",value:function(){var a="calc(-"+14*this.tab+"px - "+100*this.tab+"%)";f.css(this.carouselnode,"left",a)}},{key:"next",value:function(){this["goto"](this.tab,this.tab+1)}},{key:"pagecount",value:function(){return this.tab}},{key:"previous",value:function(){this["goto"](this.tab,this.tab-1)}},{key:"ensureVisible",value:function(){}}]),a}();rh.controller("Carousel",i)},{"../../../lib/rh":24}],66:[function(a,b,c){"use strict";var rh=a("../../lib/rh"),d=rh.$;b.exports={nodeType:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},removeChild:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parentNode(a);return b&&b.removeChild&&b.removeChild(a)},appendChild:function(a,b){return a&&a.appendChild&&a.appendChild(b)},parentNode:function(a){return a&&a.parentNode},childNodes:function(a){return a&&a.childNodes||[]},toHtmlNode:function(a){return this.childNodes(d.createElement("div",a))},outerHTML:function(a){return a&&a.outerHTML||""},insertAfter:function(a,b){return a.parentNode.insertBefore(b,a.nextSibling)},value:function(a){return a&&a.nodeValue},name:function(a){return a&&a.nodeName},type:function(a){return a&&a.nodeType},isElementNode:function(a){return this.type(a)===this.nodeType.ELEMENT_NODE},isTextNode:function(a){return this.type(a)===this.nodeType.TEXT_NODE}}},{"../../lib/rh":24}]},{},[26]);